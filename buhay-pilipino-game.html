<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buhay Pilipino: A Life Simulation</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Lobster&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <style>
    /* Background texture from transparenttextures.com (free resource) */
    body {
      font-family: 'Open Sans', sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
      background-image: url("https://www.transparenttextures.com/patterns/old-mat.png");
      color: #333;
    }

    h1, h2, h3 {
      font-family: 'Lobster', cursive;
      color: #8b4513;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }

    h1 {
      text-align: center;
      font-size: 2.5em;
      margin-bottom: 10px;
    }

    .subtitle {
      text-align: center;
      font-style: italic;
      margin-top: 0;
      margin-bottom: 30px;
      color: #666;
    }

    .game-container {
      background-color: rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .phase-indicator {
      background-color: #8b4513;
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      display: inline-block;
      margin-bottom: 15px;
      font-weight: bold;
    }

    .stats-container {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      margin-bottom: 20px;
      padding: 10px;
      background-color: rgba(139, 69, 19, 0.1);
      border-radius: 8px;
    }

    .stat {
      text-align: center;
      width: 16%;
      min-width: 70px;
      margin-bottom: 10px;
    }

    .stat div:first-child {
      font-size: 1.5em;
      margin-bottom: 5px;
    }

    .stat div:nth-child(2) {
      font-size: 0.8em;
      color: #666;
    }

    .stat div:last-child {
      font-weight: bold;
      font-size: 1.2em;
      color: #8b4513;
    }

    .background-options {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .background-option {
      width: 48%;
      margin-bottom: 15px;
      padding: 15px;
      background-color: rgba(255, 255, 255, 0.7);
      border: 2px solid #ddd;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .background-option:hover {
      background-color: rgba(139, 69, 19, 0.1);
      border-color: #8b4513;
    }

    .background-option.selected {
      background-color: rgba(139, 69, 19, 0.2);
      border-color: #8b4513;
    }

    .background-option h3 {
      margin-top: 0;
      margin-bottom: 10px;
    }

    .scenario {
      margin-bottom: 20px;
      line-height: 1.6;
      font-size: 1.1em;
    }

    .choices {
      margin-bottom: 20px;
    }

    .choice-btn {
      display: block;
      width: 100%;
      padding: 12px 15px;
      margin-bottom: 10px;
      background-color: #fff;
      border: 2px solid #8b4513;
      border-radius: 8px;
      text-align: left;
      font-size: 1em;
      cursor: pointer;
      transition: all 0.3s;
    }

    .choice-btn:hover {
      background-color: rgba(139, 69, 19, 0.1);
    }

    .outcome {
      background-color: rgba(139, 69, 19, 0.1);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: none;
    }

    .decision-impact {
      font-style: italic;
      color: #666;
    }

    .hidden {
      display: none;
    }

    .tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 2px solid #8b4513;
    }

    .tab {
      padding: 10px 20px;
      cursor: pointer;
      background-color: #f5f5f5;
      border-top-left-radius: 8px;
      border-top-right-radius: 8px;
      margin-right: 5px;
      transition: all 0.3s;
    }

    .tab:hover {
      background-color: rgba(139, 69, 19, 0.1);
    }

    .tab.active {
      background-color: #8b4513;
      color: white;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .relationship {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      padding: 10px;
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 8px;
      transition: all 0.3s;
    }

    .relationship:hover {
      background-color: rgba(139, 69, 19, 0.1);
    }

    .relationship-icon {
      font-size: 1.5em;
      margin-right: 15px;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(139, 69, 19, 0.2);
      border-radius: 50%;
    }

    .relationship-info {
      flex-grow: 1;
    }

    .relationship-name {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .relationship-description {
      font-size: 0.9em;
      color: #666;
      margin-bottom: 5px;
    }

    .relationship-level {
      font-size: 0.8em;
      color: #8b4513;
    }

    .memory {
      margin-bottom: 15px;
      padding: 15px;
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 8px;
      border-left: 4px solid #8b4513;
      transition: all 0.3s;
    }

    .memory:hover {
      background-color: rgba(139, 69, 19, 0.1);
    }

    .memory-age {
      font-weight: bold;
      color: #8b4513;
      margin-bottom: 5px;
    }

    .memory-text {
      margin-bottom: 5px;
    }

    .memory-category {
      font-size: 0.8em;
      color: #666;
      font-style: italic;
    }

    .memory-importance {
      display: flex;
      margin-top: 5px;
    }

    .importance-star {
      color: #8b4513;
      margin-right: 2px;
    }

    .importance-star.empty {
      color: #ddd;
    }

    .inventory-item {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      padding: 10px;
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .inventory-item:hover {
      background-color: rgba(139, 69, 19, 0.1);
    }

    .inventory-icon {
      font-size: 1.5em;
      margin-right: 15px;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(139, 69, 19, 0.2);
      border-radius: 50%;
    }

    .inventory-info {
      flex-grow: 1;
    }

    .inventory-name {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .inventory-description {
      font-size: 0.9em;
      color: #666;
    }

    .achievement {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      padding: 10px;
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 8px;
      transition: all 0.3s;
    }

    .achievement:hover {
      background-color: rgba(139, 69, 19, 0.1);
    }

    .achievement-locked {
      opacity: 0.5;
      filter: grayscale(100%);
    }

    .achievement-icon {
      font-size: 1.5em;
      margin-right: 15px;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(139, 69, 19, 0.2);
      border-radius: 50%;
    }

    .achievement-info {
      flex-grow: 1;
    }

    .achievement-name {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .achievement-description {
      font-size: 0.9em;
      color: #666;
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #8b4513;
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      transform: translateX(200%);
      transition: transform 0.3s;
      z-index: 1000;
    }

    .notification.show {
      transform: translateX(0);
    }

    .audio-controls {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: rgba(255, 255, 255, 0.8);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      font-size: 1.2em;
    }

    .cultural-values {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .cultural-value {
      width: 48%;
      margin-bottom: 10px;
      padding: 10px;
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 8px;
    }

    .cultural-value-name {
      font-weight: bold;
      margin-bottom: 5px;
      color: #8b4513;
    }

    .cultural-value-bar {
      height: 10px;
      background-color: #ddd;
      border-radius: 5px;
      overflow: hidden;
    }

    .cultural-value-fill {
      height: 100%;
      background-color: #8b4513;
    }

    .skills-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .skill {
      width: 48%;
      margin-bottom: 10px;
      padding: 10px;
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 8px;
    }

    .skill-name {
      font-weight: bold;
      margin-bottom: 5px;
      color: #8b4513;
    }

    .skill-bar {
      height: 10px;
      background-color: #ddd;
      border-radius: 5px;
      overflow: hidden;
    }

    .skill-fill {
      height: 100%;
      background-color: #8b4513;
    }

    .memory-filter {
      margin-bottom: 15px;
      display: flex;
      flex-wrap: wrap;
    }

    .memory-filter-btn {
      margin-right: 5px;
      margin-bottom: 5px;
      padding: 5px 10px;
      background-color: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 15px;
      cursor: pointer;
      font-size: 0.9em;
    }

    .memory-filter-btn.active {
      background-color: #8b4513;
      color: white;
      border-color: #8b4513;
    }

    .memory-impact {
      margin-top: 5px;
      font-size: 0.8em;
      color: #666;
    }

    .memory-impact span {
      margin-right: 10px;
    }

    .memory-impact-positive {
      color: green;
    }

    .memory-impact-negative {
      color: red;
    }

    .relationship-change {
      display: inline-block;
      margin-left: 5px;
      font-size: 0.9em;
    }

    .relationship-change.positive {
      color: green;
    }

    .relationship-change.negative {
      color: red;
    }

    .decision-tree {
      margin-top: 20px;
      padding: 15px;
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 8px;
    }

    .decision-tree-title {
      font-weight: bold;
      margin-bottom: 10px;
      color: #8b4513;
    }

    .decision-node {
      margin-left: 20px;
      margin-bottom: 10px;
      padding-left: 10px;
      border-left: 2px solid #8b4513;
    }

    .decision-node-text {
      margin-bottom: 5px;
    }

    .decision-node-outcome {
      font-size: 0.9em;
      color: #666;
      font-style: italic;
    }

    .cultural-context {
      margin-top: 10px;
      padding: 10px;
      background-color: rgba(139, 69, 19, 0.1);
      border-radius: 8px;
      font-size: 0.9em;
      font-style: italic;
    }

    .choice-cultural-context {
      font-size: 0.8em;
      color: #8b4513;
      margin-top: 5px;
      font-style: italic;
    }

    .audio-feedback {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .visual-feedback {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      opacity: 0;
      transition: opacity 0.5s;
    }

    .visual-feedback.show {
      opacity: 0.2;
    }

    .visual-feedback.positive {
      background-color: rgba(0, 255, 0, 0.1);
    }

    .visual-feedback.negative {
      background-color: rgba(255, 0, 0, 0.1);
    }

    .visual-feedback.neutral {
      background-color: rgba(255, 255, 0, 0.1);
    }

    .relationship-expectation {
      font-size: 0.8em;
      color: #666;
      margin-top: 5px;
      font-style: italic;
    }

    .memory-emotion {
      display: inline-block;
      margin-left: 10px;
      font-size: 1.2em;
    }

    .memory-connections {
      margin-top: 5px;
      font-size: 0.8em;
      color: #8b4513;
    }

    .memory-connection {
      display: inline-block;
      margin-right: 5px;
      padding: 2px 5px;
      background-color: rgba(139, 69, 19, 0.1);
      border-radius: 3px;
      cursor: pointer;
    }

    .memory-connection:hover {
      background-color: rgba(139, 69, 19, 0.2);
    }

    .filipino-expression {
      font-style: italic;
      color: #8b4513;
    }

    .cultural-value-description {
      font-size: 0.8em;
      color: #666;
      margin-top: 3px;
    }

    .life-milestone {
      margin-bottom: 15px;
      padding: 15px;
      background-color: rgba(139, 69, 19, 0.1);
      border-radius: 8px;
      border-left: 4px solid #8b4513;
    }

    .milestone-title {
      font-weight: bold;
      color: #8b4513;
      margin-bottom: 5px;
    }

    .milestone-description {
      font-size: 0.9em;
      margin-bottom: 5px;
    }

    .milestone-age {
      font-size: 0.8em;
      color: #666;
      font-style: italic;
    }

    .milestone-impact {
      margin-top: 5px;
      font-size: 0.8em;
    }

    .milestone-impact span {
      margin-right: 10px;
    }
  </style>
</head>
<body>
  <h1>Buhay Pilipino</h1>
  <p class="subtitle">A Filipino Life Simulation</p>

  <div class="game-container">
    <!-- Character Creation Phase -->
    <div id="character-creation-phase">
      <div class="phase-indicator">Character Creation</div>
      <h2>Choose Your Background</h2>
      <div class="background-options">
        <div class="background-option" data-background="urban">
          <h3>Urban Family</h3>
          <p>You grew up in Metro Manila with access to better education and opportunities, but faced the challenges of city life.</p>
          <div class="cultural-context">
            <p>Growing up in the city means you're more exposed to Western influences but still deeply rooted in Filipino values.</p>
          </div>
        </div>
        <div class="background-option" data-background="provincial">
          <h3>Provincial Family</h3>
          <p>You were raised in a provincial town with strong community ties and traditional values, but fewer economic opportunities.</p>
          <div class="cultural-context">
            <p>Life in the province emphasizes stronger family bonds and community spirit (bayanihan).</p>
          </div>
        </div>
        <div class="background-option" data-background="ofw">
          <h3>OFW Family</h3>
          <p>Your parent(s) worked abroad, providing financial stability but creating emotional distance in your family relationships.</p>
          <div class="cultural-context">
            <p>Children of OFWs often experience both privilege and sacrifice, with complex feelings of utang na loob (debt of gratitude).</p>
          </div>
        </div>
        <div class="background-option" data-background="entrepreneurial">
          <h3>Entrepreneurial Family</h3>
          <p>Your family runs a small business, teaching you resourcefulness and hard work, but with financial ups and downs.</p>
          <div class="cultural-context">
            <p>Filipino entrepreneurial families often involve all members in the business, emphasizing diskarte (resourcefulness).</p>
          </div>
        </div>
      </div>
      <button id="start-game" class="choice-btn" style="display: none;">Start Your Journey</button>
    </div>

    <!-- Main Game Phase -->
    <div id="main-game-phase" class="hidden">
      <div class="phase-indicator">Life Stage: <span id="life-stage-display">Young Adult</span></div>
      <div class="stats-container">
        <div class="stat">
          <div>💰</div>
          <div>Finances</div>
          <div id="finance-stat">50</div>
        </div>
        <div class="stat">
          <div>😊</div>
          <div>Happiness</div>
          <div id="happiness-stat">50</div>
        </div>
        <div class="stat">
          <div>👥</div>
          <div>Relationships</div>
          <div id="relationship-stat">50</div>
        </div>
        <div class="stat">
          <div>💼</div>
          <div>Career</div>
          <div id="career-stat">50</div>
        </div>
        <div class="stat">
          <div>❤️</div>
          <div>Health</div>
          <div id="health-stat">70</div>
        </div>
        <div class="stat">
          <div>🙏</div>
          <div>Spirituality</div>
          <div id="spirituality-stat">50</div>
        </div>
      </div>
      <div class="stat">
        <div id="age-display">Age: 18</div>
      </div>

      <!-- Tabs for different sections -->
      <div class="tabs">
        <div class="tab active" data-tab="main">Main</div>
        <div class="tab" data-tab="relationships">Relationships</div>
        <div class="tab" data-tab="memories">Memories</div>
        <div class="tab" data-tab="skills">Skills & Values</div>
        <div class="tab" data-tab="inventory">Inventory</div>
        <div class="tab" data-tab="achievements">Achievements</div>
      </div>

      <!-- Main Tab Content -->
      <div id="main-tab" class="tab-content active">
        <!-- Scenario and Choices -->
        <div class="scenario">
          <p id="scenario-text">You've just graduated high school. Your parents have expectations about your future, but the decision is ultimately yours. What path will you take?</p>
        </div>

        <div class="choices" id="choices-container">
          <!-- Choices will be inserted here by JavaScript -->
        </div>

        <!-- Outcome Display -->
        <div class="outcome" id="outcome-container">
          <p id="outcome-text"></p>
          <p id="decision-impact" class="decision-impact"></p>
          <button id="continue-btn" class="choice-btn">Continue</button>
        </div>
      </div>

      <!-- Relationships Tab Content -->
      <div id="relationships-tab" class="tab-content">
        <h3>Your Relationships</h3>
        <div class="relationship-container" id="relationship-container">
          <!-- Relationships will be inserted here by JavaScript -->
        </div>
      </div>

      <!-- Memories Tab Content -->
      <div id="memories-tab" class="tab-content">
        <h3>Your Memories</h3>
        <div class="memory-filter">
          <div class="memory-filter-btn active" data-filter="all">All</div>
          <div class="memory-filter-btn" data-filter="family">Family</div>
          <div class="memory-filter-btn" data-filter="career">Career</div>
          <div class="memory-filter-btn" data-filter="education">Education</div>
          <div class="memory-filter-btn" data-filter="relationship">Relationships</div>
          <div class="memory-filter-btn" data-filter="community">Community</div>
          <div class="memory-filter-btn" data-filter="personal">Personal</div>
          <div class="memory-filter-btn" data-filter="spiritual">Spiritual</div>
          <div class="memory-filter-btn" data-filter="important">Important</div>
        </div>
        <div class="memory-container" id="memory-container">
          <!-- Memories will be inserted here by JavaScript -->
        </div>
      </div>

      <!-- Skills & Values Tab Content -->
      <div id="skills-tab" class="tab-content">
        <h3>Your Skills</h3>
        <div class="skills-container" id="skills-container">
          <!-- Skills will be inserted here by JavaScript -->
        </div>
        
        <h3>Your Cultural Values</h3>
        <div class="cultural-values" id="cultural-values-container">
          <!-- Cultural values will be inserted here by JavaScript -->
        </div>
      </div>

      <!-- Inventory Tab Content -->
      <div id="inventory-tab" class="tab-content">
        <h3>Your Possessions</h3>
        <div class="inventory-container" id="inventory-container">
          <!-- Inventory items will be inserted here by JavaScript -->
        </div>
      </div>

      <!-- Achievements Tab Content -->
      <div id="achievements-tab" class="tab-content">
        <h3>Your Achievements</h3>
        <div class="achievement-container" id="achievement-container">
          <!-- Achievements will be inserted here by JavaScript -->
        </div>
      </div>
    </div>

    <!-- Game Ending Phase -->
    <div id="ending-phase" class="hidden">
      <div class="phase-indicator">Your Life's Story</div>
      <h2 id="ending-title">You've reached the end of your journey</h2>
      <div class="scenario">
        <p id="ending-description"></p>
      </div>
      <div class="stats-container">
        <div class="stat">
          <div>💰</div>
          <div>Final Finances</div>
          <div id="final-finance-stat">0</div>
        </div>
        <div class="stat">
          <div>😊</div>
          <div>Final Happiness</div>
          <div id="final-happiness-stat">0</div>
        </div>
        <div class="stat">
          <div>👥</div>
          <div>Final Relationships</div>
          <div id="final-relationship-stat">0</div>
        </div>
        <div class="stat">
          <div>💼</div>
          <div>Final Career</div>
          <div id="final-career-stat">0</div>
        </div>
        <div class="stat">
          <div>❤️</div>
          <div>Final Health</div>
          <div id="final-health-stat">0</div>
        </div>
        <div class="stat">
          <div>🙏</div>
          <div>Final Spirituality</div>
          <div id="final-spirituality-stat">0</div>
        </div>
      </div>
      <h3>Life Milestones</h3>
      <div class="memory-container" id="final-memory-container">
        <!-- Final memories will be inserted here by JavaScript -->
      </div>
      <h3>Achievements Unlocked</h3>
      <div class="achievement-container" id="final-achievement-container">
        <!-- Final achievements will be inserted here by JavaScript -->
      </div>

      <button id="restart-game" class="choice-btn">Start a New Life</button>
    </div>
  </div>

  <!-- Notification Element -->
  <div class="notification" id="notification">Achievement unlocked!</div>

  <!-- Audio Controls -->
  <div class="audio-controls" id="toggle-music">🔇</div>

  <!-- Audio and Visual Feedback Elements -->
  <div class="audio-feedback" id="audio-feedback"></div>
  <div class="visual-feedback" id="visual-feedback"></div>

  <script>
    // Game State with enhanced features
    const gameState = {
      age: 18,
      lifeStage: "Young Adult",
      background: "",
      stats: {
        finances: 50,
        happiness: 50,
        relationships: 50,
        career: 50,
        health: 70,
        spirituality: 50
      },
      skills: {
        education: 10,
        social: 10,
        technical: 10,
        creativity: 10,
        resilience: 10,
        leadership: 10,
        cooking: 5,
        language: 15, // Filipino language skills
        resourcefulness: 20,
        adaptability: 15,
        negotiation: 5,
        teaching: 5,
        management: 5,
        networking: 5
      },
      culturalValues: {
        utangNaLoob: 30, // Debt of gratitude
        pakikisama: 40, // Getting along with others
        bayanihan: 25, // Community spirit
        familyPiety: 60, // Respect for family
        hiya: 35, // Sense of shame/propriety
        delicadeza: 30, // Sense of propriety
        pagiging_matiisin: 40, // Perseverance/endurance
        pagiging_masipag: 45, // Industriousness
        respeto: 50, // Respect for elders
        faith: 45, // Religious/spiritual faith
        pagtitiis: 35, // Endurance/sacrifice
        diskarte: 30, // Resourcefulness/street smarts
        kapwa: 40, // Shared identity
        amor_propio: 35 // Self-esteem/dignity
      },
      relationships: [
        {
          id: "family",
          name: "Family",
          level: 50,
          type: "family",
          unlocked: true,
          description: "Your immediate family who raised you with Filipino values.",
          expectations: "They expect you to succeed and support them as they age.",
          history: []
        },
        {
          id: "friends",
          name: "Friends",
          level: 50,
          type: "friends",
          unlocked: true,
          description: "Your general circle of friends from school and neighborhood.",
          expectations: "They expect you to join gatherings and maintain connections.",
          history: []
        },
        {
          id: "romantic",
          name: "Romantic",
          level: 0,
          type: "romantic",
          unlocked: false,
          description: "A potential life partner who shares your values.",
          expectations: "They would expect commitment and family-oriented decisions.",
          history: []
        },
        {
          id: "tito_ben",
          name: "Tito Ben",
          level: 30,
          type: "family",
          unlocked: true,
          description: "Your father's brother who works as a successful engineer.",
          expectations: "He expects you to value education and professional growth.",
          history: []
        },
        {
          id: "tita_maria",
          name: "Tita Maria",
          level: 30,
          type: "family",
          unlocked: true,
          description: "Your mother's sister who always brings pasalubong from her travels.",
          expectations: "She expects you to visit during special occasions and help with family matters.",
          history: []
        },
        {
          id: "lola",
          name: "Lola",
          level: 60,
          type: "family",
          unlocked: true,
          description: "Your grandmother who taught you traditional Filipino values and cooking.",
          expectations: "She expects you to preserve family traditions and respect elders.",
          history: []
        },
        {
          id: "barkada",
          name: "Barkada",
          level: 40,
          type: "friends",
          unlocked: true,
          description: "Your close-knit group of friends who've been with you since high school.",
          expectations: "They expect loyalty and regular bonding time.",
          history: []
        },
        {
          id: "kapitbahay",
          name: "Kapitbahay",
          level: 30,
          type: "community",
          unlocked: true,
          description: "Your neighbors who are always aware of community happenings.",
          expectations: "They expect participation in community events and adherence to local norms.",
          history: []
        },
        {
          id: "mentor",
          name: "Mentor",
          level: 20,
          type: "career",
          unlocked: true,
          description: "A teacher or professional who guides your development.",
          expectations: "They expect you to work hard and apply their teachings.",
          history: []
        },
        {
          id: "ninong",
          name: "Ninong",
          level: 25,
          type: "family",
          unlocked: true,
          description: "Your godfather who has supported your education.",
          expectations: "He expects respect and occasional visits during important occasions.",
          history: []
        },
        {
          id: "parish_community",
          name: "Parish Community",
          level: 20,
          type: "community",
          unlocked: true,
          description: "The religious community at your local church.",
          expectations: "They expect attendance at religious events and moral behavior.",
          history: []
        },
        {
          id: "suki",
          name: "Suki",
          level: 15,
          type: "community",
          unlocked: true,
          description: "Regular vendors at the local market who give you special treatment.",
          expectations: "They expect your continued patronage and occasional small talk.",
          history: []
        }
      ],
      memories: [],
      inventory: [],
      achievements: [
        { id: "graduate_college", name: "College Graduate", description: "Complete your college education", unlocked: false, icon: "🎓" },
        { id: "first_job", name: "First Job", description: "Get your first job", unlocked: false, icon: "💼" },
        { id: "utang_na_loob", name: "Utang na Loob", description: "Repay your parents' sacrifices", unlocked: false, icon: "🙏" },
        { id: "bayanihan", name: "Bayanihan Spirit", description: "Help your community in times of need", unlocked: false, icon: "🤝" },
        { id: "ofw_sacrifice", name: "OFW Journey", description: "Work abroad to support your family", unlocked: false, icon: "✈️" },
        { id: "entrepreneur", name: "Pinoy Entrepreneur", description: "Start your own successful business", unlocked: false, icon: "🏪" },
        { id: "family_first", name: "Family First", description: "Prioritize family in major decisions", unlocked: false, icon: "👨‍👩‍👧" },
        { id: "fiesta_host", name: "Fiesta Host", description: "Host a memorable fiesta celebration", unlocked: false, icon: "🎉" },
        { id: "pakikisama_master", name: "Pakikisama Master", description: "Maintain harmony in all your relationships", unlocked: false, icon: "☯️" },
        { id: "balikbayan", name: "Balikbayan Box Hero", description: "Send care packages to loved ones", unlocked: false, icon: "📦" },
        { id: "cultural_pride", name: "Cultural Pride", description: "Actively preserve and promote Filipino culture", unlocked: false, icon: "🇵🇭" },
        { id: "resilient_spirit", name: "Resilient Spirit", description: "Overcome significant hardships with grace", unlocked: false, icon: "🌱" },
        { id: "community_pillar", name: "Community Pillar", description: "Become a respected leader in your community", unlocked: false, icon: "🏛️" },
        { id: "family_legacy", name: "Family Legacy", description: "Create a lasting positive impact for future generations", unlocked: false, icon: "👪" },
        { id: "balanced_life", name: "Balanced Life", description: "Achieve harmony across all aspects of life", unlocked: false, icon: "⚖️" }
      ],
      careerPath: "",
      currentScenario: null,
      causeOfDeath: "",
      isDead: false,
      // Decision history tracking
      decisionHistory: [],
      // Pending consequences from past decisions
      pendingConsequences: [],
      // Life milestones
      milestones: []
    };

    // Inventory Items with Filipino cultural significance
    const inventoryItems = [
      { id: "panyo", name: "Lola's Panyo", description: "A handkerchief from your grandmother, brings comfort in difficult times", icon: "🧣", effect: { happiness: 5 }, culturalContext: "The panyo symbolizes the wisdom and care passed down through generations." },
      { id: "medal", name: "School Medal", description: "A medal from your academic achievements", icon: "🏅", effect: { career: 5 }, culturalContext: "Academic achievement is highly valued in Filipino families as a path to success." },
      { id: "rosary", name: "Family Rosary", description: "Passed down through generations, brings spiritual comfort", icon: "📿", effect: { spirituality: 10, relationships: 5 }, culturalContext: "The rosary represents the strong Catholic faith that influences many Filipino families." },
      { id: "cookbook", name: "Family Recipes", description: "Traditional Filipino recipes from your family", icon: "📖", effect: { happiness: 5, relationships: 3, cooking: 5 }, culturalContext: "Food is central to Filipino culture and family gatherings." },
      { id: "barong", name: "Barong Tagalog", description: "Traditional formal attire for special occasions", icon: "👔", effect: { career: 5, relationships: 3 }, culturalContext: "The barong represents Filipino identity and professionalism in formal settings." },
      { id: "tsinelas", name: "Lucky Tsinelas", description: "Your favorite pair of slippers that have lasted for years", icon: "👡", effect: { happiness: 3 }, culturalContext: "Tsinelas represent the Filipino value of simplicity and practicality." },
      { id: "balikbayan_box", name: "Balikbayan Box", description: "A box full of goods from relatives abroad", icon: "📦", effect: { finances: 10, happiness: 5 }, culturalContext: "Balikbayan boxes symbolize the connection between OFWs and their families back home." },
      { id: "sundo_card", name: "Sundo Card", description: "A card from when someone picked you up at the airport", icon: "💌", effect: { relationships: 8 }, culturalContext: "Being 'sundô' (picked up) is an important gesture of care in Filipino culture." },
      { id: "diploma", name: "College Diploma", description: "Proof of your educational achievement", icon: "🎓", effect: { career: 10 }, culturalContext: "Education is seen as the key to success and family pride in the Philippines." },
      { id: "family_photo", name: "Family Photo", description: "A cherished photo of your family", icon: "🖼️", effect: { relationships: 10, happiness: 5 }, culturalContext: "Family photos are treasured reminders of the central importance of family in Filipino life." },
      { id: "business_card", name: "First Business Card", description: "Your first professional business card", icon: "📇", effect: { career: 8 }, culturalContext: "Business cards represent professional achievement and connections in Filipino society." },
      { id: "palaspas", name: "Palm Sunday Palaspas", description: "Intricately woven palm frond from Palm Sunday", icon: "🌿", effect: { spirituality: 5, happiness: 3 }, culturalContext: "Palaspas represent religious traditions and are believed to bring blessings to the home." },
      { id: "anting_anting", name: "Anting-Anting", description: "A traditional amulet believed to provide protection", icon: "🔮", effect: { spirituality: 5, resilience: 3 }, culturalContext: "Anting-anting blend Catholic and indigenous beliefs, representing Filipino folk spirituality." },
      { id: "bayong", name: "Handwoven Bayong", description: "A traditional market bag made from natural materials", icon: "👜", effect: { happiness: 3, resourcefulness: 5 }, culturalContext: "The bayong represents sustainable Filipino practices and connection to local markets." },
      { id: "sari_sari_ledger", name: "Sari-Sari Store Ledger", description: "A notebook recording neighborhood credit (utang)", icon: "📒", effect: { finances: 5, relationships: 5 }, culturalContext: "The utang system in sari-sari stores reflects the trust and community bonds in Filipino neighborhoods." },
      { id: "kakanin_recipe", name: "Secret Kakanin Recipe", description: "A traditional Filipino dessert recipe passed down in your family", icon: "🍡", effect: { cooking: 10, happiness: 5 }, culturalContext: "Traditional recipes are treasured family heirlooms that preserve cultural heritage." }
    ];

    // Scenario Database with enhanced cultural elements
    const scenarios = {
      // Young Adult (18-25)
      youngAdult: [
        {
          id: "college-choice",
          text: "Your parents insist that you either study a practical course or go abroad. What do you do?",
          culturalContext: "In Filipino families, parents often have strong influence over educational choices, with practical courses (nursing, engineering, physics <3, etc.) being highly valued for job prospects.",
          choices: [
            {
              text: "Follow your parents' advice and pursue a practical degree.",
              culturalContext: "This choice honors the Filipino value of respeto (respect for elders) and utang na loob (debt of gratitude) to parents.",
              outcome: "You enroll in a nursing program as your parents suggested. It's challenging but offers good prospects.",
              stats: { finances: -10, happiness: -5, relationships: +15, career: +10 },
              skills: { education: +15, resilience: +10 },
              culturalValues: { utangNaLoob: +15, respeto: +10 },
              memory: "You chose to follow your parents' advice about your education.",
              category: "education",
              importance: 4,
              emotion: "😌",
              relationships: [{ id: "family", change: +15 }]
            },
            {
              text: "Pursue your passion in Arts.",
              culturalContext: "This choice challenges traditional Filipino expectations but reflects growing individualism among younger generations.",
              outcome: "Against your parents' wishes, you follow your heart. The initial years are challenging but fulfilling.",
              stats: { finances: -15, happiness: +15, relationships: -10, career: +5 },
              skills: { education: +10, creativity: +20 },
              culturalValues: { hiya: -5, utangNaLoob: -5, amor_propio: +15 },
              memory: "You chose to follow your passion despite family pressure.",
              category: "education",
              importance: 4,
              emotion: "🎨",
              relationships: [{ id: "family", change: -10 }]
            },
            {
              text: "Negotiate a compromise with your parents.",
              culturalContext: "This approach reflects pakikisama (getting along) and finding middle ground while maintaining family harmony.",
              outcome: "After a heart-to-heart talk, your parents agree to support your choice if you minor in a practical field.",
              stats: { finances: -10, happiness: +10, relationships: +5, career: +10 },
              skills: { education: +10, social: +10, creativity: +10, negotiation: +15 },
              culturalValues: { pakikisama: +10, utangNaLoob: +5 },
              memory: "You found a compromise with your parents about your education.",
              category: "education",
              importance: 3,
              emotion: "🤝",
              relationships: [{ id: "family", change: +5 }]
            },
            {
              text: "Drop out and start a small online business.",
              culturalContext: "This represents the Filipino value of diskarte (resourcefulness) but challenges traditional educational expectations.",
              outcome: "You take a risk and start a small online business. Your parents are worried but somewhat supportive.",
              stats: { finances: -20, happiness: +10, relationships: -5, career: +5 },
              skills: { technical: +15, creativity: +10, leadership: +15, diskarte: +20 },
              culturalValues: { hiya: -10, diskarte: +20 },
              memory: "You decided to start your own business instead of going to college.",
              category: "career",
              importance: 5,
              emotion: "💼",
              relationships: [{ id: "family", change: -5 }],
              randomEvent: {
                chance: 0.3,
                event: {
                  text: "Your business unexpectedly goes viral! Orders are pouring in faster than you can handle.",
                  stats: { finances: +30, happiness: +10, career: +20 },
                  skills: { technical: +10, leadership: +15 },
                  culturalValues: { bayanihan: +5, diskarte: +15 },
                  memory: "Your small business went viral and became successful!",
                  category: "career",
                  importance: 5,
                  emotion: "🚀",
                  relationships: [{ id: "family", change: +15 }],
                  unlockAchievement: "entrepreneur"
                }
              }
            }
          ]
        },
        {
          id: "barkada-pressure",
          text: "Your barkada invites you to go out drinking when you have an important exam/deadline tomorrow. What do you do?",
          culturalContext: "Barkada (close friend group) relationships are extremely important in Filipino culture, often creating tension between social obligations and personal responsibilities.",
          choices: [
            {
              text: "Go out with them. YOLO!",
              culturalContext: "Prioritizing pakikisama (getting along) with friends over personal responsibilities.",
              outcome: "You have a great time but perform poorly on your exam/work the next day.",
              stats: { finances: -10, happiness: +5, relationships: +15, career: -15 },
              skills: { social: +10, education: -10 },
              culturalValues: { pakikisama: +15, hiya: -5 },
              memory: "You chose your barkada over your responsibilities.",
              category: "relationship",
              importance: 2,
              emotion: "🍻",
              relationships: [{ id: "barkada", change: +20 }, { id: "mentor", change: -10 }]
            },
            {
              text: "Decline and focus on your responsibilities.",
              culturalContext: "Choosing personal advancement over social obligations, which can be seen as being KJ (killjoy) in Filipino social contexts.",
              outcome: "You ace your exam/work, but your friends tease you for being a 'KJ' (killjoy).",
              stats: { finances: 0, happiness: -5, relationships: -10, career: +20 },
              skills: { education: +15, resilience: +10 },
              culturalValues: { pakikisama: -10, hiya: +5, pagiging_masipag: +15 },
              memory: "You prioritized your responsibilities over your barkada's invitation.",
              category: "education",
              importance: 2,
              emotion: "📚",
              relationships: [{ id: "barkada", change: -10 }, { id: "mentor", change: +10 }]
            },
            {
              text: "Suggest an alternative hangout time after your deadline.",
              culturalContext: "Finding a middle path that honors both pakikisama and personal responsibilities - a very Filipino approach to conflict resolution.",
              outcome: "Your friends understand and reschedule. You manage to balance your social life and responsibilities.",
              stats: { finances: 0, happiness: +5, relationships: +5, career: +10 },
              skills: { social: +10, education: +5, leadership: +5, negotiation: +10 },
              culturalValues: { pakikisama: +10, diskarte: +5 },
              memory: "You found a way to balance your social life and responsibilities.",
              category: "relationship",
              importance: 1,
              emotion: "⚖️",
              relationships: [{ id: "barkada", change: +10 }, { id: "mentor", change: +5 }]
            },
            {
              text: "Go out briefly but leave early to study.",
              culturalContext: "A compromise that shows pakikisama while still prioritizing responsibilities - saving face (hiya) with friends while being responsible.",
              outcome: "You show face at the gathering but prioritize your studies. Your friends appreciate the effort.",
              stats: { finances: -5, happiness: 0, relationships: +5, career: +5 },
              skills: { social: +5, education: +5, resilience: +5 },
              culturalValues: { pakikisama: +5, diskarte: +10 },
              memory: "You made a brief appearance at your barkada's gathering before returning to study.",
              category: "relationship",
              importance: 1,
              emotion: "🕒",
              relationships: [{ id: "barkada", change: +5 }, { id: "mentor", change: +5 }]
            }
          ]
        },
        {
          id: "family-financial-crisis",
          text: "Your family is facing a financial crisis. Your younger sibling's tuition fee is due, but you were saving for your own needs. What do you do?",
          culturalContext: "In Filipino culture, family needs often take precedence over individual desires, with strong expectations to support family members in need.",
          choices: [
            {
              text: "Give all your savings to help your sibling.",
              culturalContext: "This embodies the Filipino value of family first and sacrificing personal needs for family welfare.",
              outcome: "You sacrifice your plans to ensure your sibling's education continues. Your family is deeply grateful.",
              stats: { finances: -25, happiness: +5, relationships: +25, career: -5 },
              skills: { resilience: +15 },
              culturalValues: { utangNaLoob: +20, familyPiety: +25, bayanihan: +10 },
              memory: "You sacrificed your savings to help your sibling's education.",
              category: "family",
              importance: 5,
              emotion: "❤️",
              relationships: [{ id: "family", change: +25 }],
              unlockAchievement: "family_first",
              addInventory: "family_photo",
              pendingConsequences: [
                {
                  triggerAge: 30,
                  text: "Your sibling, now a successful professional, surprises you with a significant financial gift.",
                  stats: { finances: +30, happiness: +15 },
                  memory: "Your sibling repaid your sacrifice with a generous gift.",
                  category: "family",
                  importance: 4,
                  relationships: [{ id: "family", change: +10 }]
                }
              ]
            },
            {
              text: "Give half your savings and help find alternative solutions.",
              culturalContext: "This balances family obligation with personal needs, using diskarte (resourcefulness) to find multiple solutions.",
              outcome: "You contribute what you can while helping your family explore scholarships and payment plans.",
              stats: { finances: -15, happiness: +10, relationships: +15, career: 0 },
              skills: { social: +10, resilience: +10, negotiation: +10 },
              culturalValues: { utangNaLoob: +10, familyPiety: +15, bayanihan: +15, diskarte: +15 },
              memory: "You shared your savings and helped find solutions for your sibling's education.",
              category: "family",
              importance: 3,
              emotion: "🤝",
              relationships: [{ id: "family", change: +15 }]
            },
            {
              text: "Loan the money with a repayment plan.",
              culturalContext: "This introduces a more Western approach to family finances, which can clash with traditional Filipino expectations of unconditional family support.",
              outcome: "You help out but make it clear it's a loan. Your family understands but feels a bit disappointed.",
              stats: { finances: -10, happiness: 0, relationships: -5, career: +5 },
              skills: { leadership: +5, negotiation: +5 },
              culturalValues: { utangNaLoob: -5, familyPiety: -5, bayanihan: -5, amor_propio: +10 },
              memory: "You loaned money to your family for your sibling's education.",
              category: "family",
              importance: 3,
              emotion: "💰",
              relationships: [{ id: "family", change: -5 }]
            },
            {
              text: "Decline and focus on your own needs.",
              culturalContext: "This directly challenges the Filipino value of family first and may be seen as selfish or lacking in utang na loob.",
              outcome: "You prioritize your own financial stability. Family relations become strained.",
              stats: { finances: +5, happiness: -15, relationships: -25, career: +5 },
              skills: { resilience: +5 },
              culturalValues: { utangNaLoob: -20, familyPiety: -25, hiya: +15 },
              memory: "You declined to help your family during their financial crisis.",
              category: "family",
              importance: 4,
              emotion: "😔",
              relationships: [{ id: "family", change: -25 }],
              pendingConsequences: [
                {
                  triggerAge: 25,
                  text: "Your decision to prioritize yourself has created lasting tension in family gatherings.",
                  stats: { happiness: -10, relationships: -10 },
                  memory: "Family gatherings remain tense due to your past decision not to help financially.",
                  category: "family",
                  importance: 3,
                  relationships: [{ id: "family", change: -10 }]
                }
              ],
              randomEvent: {
                chance: 0.4,
                event: {
                  text: "The strain from family rejection leads to severe depression. You struggle to cope with the emotional toll.",
                  stats: { happiness: -30, relationships: -10, health: -15 },
                  memory: "You fell into depression after your family relations deteriorated.",
                  category: "personal",
                  importance: 4,
                  emotion: "😢",
                  relationships: [{ id: "family", change: -10 }]
                }
              }
            }
          ]
        },
        {
          id: "barangay-fiesta",
          text: "It's your barangay's annual fiesta. How do you participate?",
          culturalContext: "Fiestas are central to Filipino community life, with participation reflecting one's commitment to local culture and community bonds.",
          choices: [
            {
              text: "Volunteer to organize activities and help with preparations.",
              culturalContext: "This embodies bayanihan (community spirit) and active participation in cultural traditions.",
              outcome: "You become an integral part of the fiesta preparations. The community appreciates your dedication.",
              stats: { finances: -5, happiness: +15, relationships: +20, career: +5 },
              skills: { social: +15, leadership: +20, management: +10 },
              culturalValues: { bayanihan: +25, pakikisama: +15 },
              memory: "You volunteered to help organize your barangay's fiesta.",
              category: "community",
              importance: 3,
              emotion: "🎉",
              relationships: [{ id: "kapitbahay", change: +25 }, { id: "parish_community", change: +10 }],
              unlockAchievement: "bayanihan",
              pendingConsequences: [
                {
                  triggerAge: 30,
                  text: "Your reputation as a community organizer leads to an invitation to join the barangay council.",
                  stats: { relationships: +15, career: +10 },
                  memory: "Your community service led to an invitation to join local governance.",
                  category: "community",
                  importance: 3,
                  relationships: [{ id: "kapitbahay", change: +15 }]
                }
              ]
            },
            {
              text: "Contribute financially but limit your participation.",
              culturalContext: "This shows support while maintaining distance - a common approach for busier or more private Filipinos.",
              outcome: "You donate to the festivities but keep a low profile. Your contribution is acknowledged.",
              stats: { finances: -10, happiness: +5, relationships: +10, career: 0 },
              skills: { social: +5 },
              culturalValues: { bayanihan: +10, pakikisama: +5 },
              memory: "You contributed financially to your barangay's fiesta.",
              category: "community",
              importance: 2,
              emotion: "💵",
              relationships: [{ id: "kapitbahay", change: +10 }]
            },
            {
              text: "Attend the festivities and socialize with neighbors.",
              culturalContext: "This reflects pakikisama (getting along) and participation in community life without taking leadership.",
              outcome: "You enjoy the celebration and strengthen community bonds through casual interactions.",
              stats: { finances: -5, happiness: +10, relationships: +15, career: 0 },
              skills: { social: +10 },
              culturalValues: { pakikisama: +15, bayanihan: +5 },
              memory: "You attended and enjoyed your barangay's fiesta celebrations.",
              category: "community",
              importance: 2,
              emotion: "🥳",
              relationships: [{ id: "kapitbahay", change: +15 }]
            },
            {
              text: "Skip the fiesta to focus on personal matters.",
              culturalContext: "This challenges community expectations and may be seen as lacking pakikisama or community spirit.",
              outcome: "You miss the community bonding opportunity. Some neighbors notice your absence.",
              stats: { finances: 0, happiness: -5, relationships: -10, career: +5 },
              skills: { technical: +5 },
              culturalValues: { pakikisama: -15, bayanihan: -10 },
              memory: "You skipped your barangay's fiesta to focus on personal matters.",
              category: "community",
              importance: 2,
              emotion: "🏃",
              relationships: [{ id: "kapitbahay", change: -15 }],
              pendingConsequences: [
                {
                  triggerAge: 25,
                  text: "Your neighbors are less willing to help when you face a household emergency.",
                  stats: { relationships: -10 },
                  memory: "Your lack of community participation affected how neighbors responded to your needs.",
                  category: "community",
                  importance: 2,
                  relationships: [{ id: "kapitbahay", change: -10 }]
                }
              ]
            }
          ]
        },
        {
          id: "first-job-interview",
          text: "You've been called for your first big job interview. How do you prepare?",
          culturalContext: "Job interviews in the Philippines often blend Western professional standards with Filipino cultural expectations about modesty and connections.",
          choices: [
            {
              text: "Research extensively and practice with friends.",
              culturalContext: "This approach combines Western preparation with Filipino collaborative learning through friends.",
              outcome: "Your thorough preparation impresses the interviewers. You answer questions confidently and professionally.",
              stats: { finances: +5, happiness: +10, career: +15 },
              skills: { education: +10, technical: +15, social: +10 },
              culturalValues: { pagiging_masipag: +15 },
              memory: "You thoroughly prepared for your first job interview.",
              category: "career",
              importance: 3,
              emotion: "📚",
              relationships: [{ id: "mentor", change: +10 }]
            },
            {
              text: "Rely on your natural charm and abilities.",
              culturalContext: "This reflects the Filipino value of pakikisama and interpersonal skills sometimes being valued over technical knowledge.",
              outcome: "You make a good impression personally, but struggle with some technical questions.",
              stats: { happiness: +5, relationships: +5, career: +5 },
              skills: { social: +15 },
              culturalValues: { pakikisama: +10, diskarte: +5 },
              memory: "You relied on your charm for your first job interview.",
              category: "career",
              importance: 2,
              emotion: "😊",
              relationships: [{ id: "mentor", change: +5 }],
              randomEvent: {
                chance: 0.4,
                event: {
                  text: "Despite the technical gaps, the interviewer likes your confidence and offers you the job!",
                  stats: { finances: +15, happiness: +15, career: +10 },
                  skills: { social: +10 },
                  culturalValues: { diskarte: +15 },
                  memory: "You got your first job despite technical gaps in your interview!",
                  category: "career",
                  importance: 4,
                  emotion: "🎯",
                  relationships: [{ id: "mentor", change: +5 }],
                  unlockAchievement: "first_job",
                  addInventory: "business_card"
                }
              }
            },
            {
              text: "Ask for connections from family or friends (padrino system).",
              culturalContext: "The 'padrino system' (using connections) is a common but sometimes criticized practice in Filipino professional life.",
              outcome: "Your tito puts in a good word for you with the hiring manager.",
              stats: { relationships: -5, career: +10 },
              skills: { social: +5, networking: +15 },
              culturalValues: { utangNaLoob: +15, hiya: +10, delicadeza: -10 },
              memory: "You used family connections to help secure your first job.",
              category: "career",
              importance: 3,
              emotion: "🤫",
              relationships: [{ id: "tito_ben", change: -5 }, { id: "mentor", change: -10 }],
              pendingConsequences: [
                {
                  triggerAge: 25,
                  text: "Your colleagues discover you were hired through connections, affecting your workplace relationships.",
                  stats: { relationships: -10, career: -5 },
                  memory: "Your use of connections (padrino system) damaged your professional reputation.",
                  category: "career",
                  importance: 3,
                  relationships: [{ id: "mentor", change: -10 }]
                }
              ]
            },
            {
              text: "Seek advice from your mentor and prepare diligently.",
              culturalContext: "This combines respect for elders/mentors with personal responsibility - a balanced Filipino approach.",
              outcome: "Your mentor provides valuable insights that help you prepare effectively for the interview.",
              stats: { happiness: +5, relationships: +10, career: +15 },
              skills: { education: +10, technical: +10, social: +5 },
              culturalValues: { respeto: +10, pagiging_masipag: +10, utangNaLoob: +5 },
              memory: "Your mentor helped you prepare for your first job interview.",
              category: "career",
              importance: 3,
              emotion: "🧠",
              relationships: [{ id: "mentor", change: +15 }],
              pendingConsequences: [
                {
                  triggerAge: 30,
                  text: "Your mentor recommends you for a promotion, citing your growth since that first interview.",
                  stats: { career: +15, finances: +10 },
                  memory: "Your mentor's continued support advanced your career.",
                  category: "career",
                  importance: 3,
                  relationships: [{ id: "mentor", change: +10 }]
                }
              ]
            }
          ]
        },
        {
          id: "lolas-birthday",
          text: "It's your Lola's 80th birthday celebration. You're very busy with work/school, but your family expects you to not only attend but help with preparations. What do you do?",
          culturalContext: "Respecting elders, especially grandparents, is a core Filipino value. Birthday celebrations for elderly family members are significant cultural events.",
          choices: [
            {
              text: "Take time off to fully participate in preparations and celebration.",
              culturalContext: "This prioritizes family obligations and respect for elders over work/school - a traditional Filipino approach.",
              outcome: "Your Lola is overjoyed by your dedication. The celebration is a success, and family bonds strengthen.",
              stats: { finances: -5, happiness: +15, relationships: +20, career: -5 },
              skills: { social: +10, cooking: +5 },
              culturalValues: { familyPiety: +20, respeto: +15, utangNaLoob: +10 },
              memory: "You dedicated yourself to making your Lola's 80th birthday special.",
              category: "family",
              importance: 4,
              emotion: "👵",
              relationships: [{ id: "lola", change: +25 }, { id: "family", change: +15 }],
              addInventory: "family_photo",
              pendingConsequences: [
                {
                  triggerCondition: { relationship: "lola", operator: ">", value: 70 },
                  text: "Your Lola shares family heirloom recipes with you, saying you're the only one who appreciates tradition.",
                  memory: "Your Lola entrusted you with precious family recipes.",
                  category: "family",
                  importance: 4,
                  addInventory: "kakanin_recipe",
                  relationships: [{ id: "lola", change: +10 }]
                }
              ]
            },
            {
              text: "Attend the celebration but limit your involvement in preparations.",
              culturalContext: "This balances family obligations with personal responsibilities - a modern Filipino approach.",
              outcome: "You show up for the important parts. Your family appreciates your presence, though some note your limited involvement.",
              stats: { finances: -5, happiness: +5, relationships: +5, career: 0 },
              skills: { social: +5 },
              culturalValues: { familyPiety: +5, respeto: +5 },
              memory: "You attended your Lola's birthday while balancing other responsibilities.",
              category: "family",
              importance: 2,
              emotion: "🎂",
              relationships: [{ id: "lola", change: +10 }, { id: "family", change: +5 }]
            },
            {
              text: "Send a gift but explain you can't attend due to important deadlines.",
              culturalContext: "This challenges traditional expectations but attempts to mitigate through a gift - a compromise approach.",
              outcome: "Your absence is noted and disappoints your Lola, though she appreciates the gift. Family members are understanding but disappointed.",
              stats: { finances: -10, happiness: -5, relationships: -10, career: +10 },
              skills: { technical: +5 },
              culturalValues: { familyPiety: -15, respeto: -10, hiya: +15 },
              memory: "You missed your Lola's 80th birthday due to work/school commitments.",
              category: "family",
              importance: 3,
              emotion: "📦",
              relationships: [{ id: "lola", change: -15 }, { id: "family", change: -10 }],
              pendingConsequences: [
                {
                  triggerAge: 30,
                  text: "Years later, you realize how few birthdays your Lola had left, and regret your choice.",
                  stats: { happiness: -10 },
                  memory: "You regret missing important family celebrations with your Lola.",
                  category: "family",
                  importance: 4,
                  emotion: "😢"
                }
              ]
            },
            {
              text: "Negotiate with work/school to attend part of the celebration and contribute uniquely.",
              culturalContext: "This uses diskarte (resourcefulness) to find a creative solution that honors both obligations.",
              outcome: "You arrange to create a special video tribute and attend the main celebration. Your unique contribution is highly appreciated.",
              stats: { finances: -5, happiness: +10, relationships: +15, career: 0 },
              skills: { social: +5, creativity: +10, negotiation: +15 },
              culturalValues: { familyPiety: +10, respeto: +10, diskarte: +15 },
              memory: "You found a creative way to honor your Lola while managing your responsibilities.",
              category: "family",
              importance: 3,
              emotion: "🎬",
              relationships: [{ id: "lola", change: +15 }, { id: "family", change: +10 }],
              addInventory: "family_photo"
            }
          ]
        }
      ],
      
      // Adult (26-40)
      adult: [
        {
          id: "career-crossroads",
          text: "You've been offered a prestigious job abroad with double your current salary, but it means leaving your family and community. What do you do?",
          culturalContext: "This reflects the common Filipino OFW (Overseas Filipino Worker) dilemma of economic opportunity versus family separation.",
          choices: [
            {
              text: "Accept the overseas job to provide better for your family.",
              culturalContext: "Many Filipinos choose this path of sacrifice, prioritizing financial provision over physical presence.",
              outcome: "You move abroad and send money home regularly. Your family's financial situation improves significantly, but you miss important milestones.",
              stats: { finances: +30, happiness: -10, relationships: -15, career: +20 },
              skills: { resilience: +20, adaptability: +15, technical: +10 },
              culturalValues: { familyPiety: +10, pagiging_matiisin: +20, utangNaLoob: +15 },
              memory: "You chose to work abroad to provide better financial support for your family.",
              category: "career",
              importance: 5,
              emotion: "✈️",
              relationships: [{ id: "family", change: -10 }],
              unlockAchievement: "ofw_sacrifice",
              pendingConsequences: [
                {
                  triggerAge: 35,
                  text: "After years abroad, you've saved enough to start a business back home in the Philippines.",
                  stats: { finances: +20, happiness: +15, relationships: +10 },
                  memory: "Your years as an OFW allowed you to return and start a business in the Philippines.",
                  category: "career",
                  importance: 4,
                  relationships: [{ id: "family", change: +15 }],
                  unlockAchievement: "entrepreneur"
                }
              ]
            },
            {
              text: "Decline the offer to stay close to your loved ones.",
              culturalContext: "This prioritizes family presence and community bonds over financial advancement.",
              outcome: "You remain in the Philippines with more modest finances but strong family and community connections.",
              stats: { finances: -10, happiness: +15, relationships: +20, career: -5 },
              skills: { social: +10, creativity: +5 },
              culturalValues: { familyPiety: +15, pakikisama: +10, kapwa: +15 },
              memory: "You chose family and community over financial opportunity abroad.",
              category: "family",
              importance: 4,
              emotion: "👨‍👩‍👧",
              relationships: [{ id: "family", change: +20 }, { id: "kapitbahay", change: +10 }],
              pendingConsequences: [
                {
                  triggerAge: 35,
                  text: "Your consistent presence has made you a respected figure in your community.",
                  stats: { relationships: +15, happiness: +10 },
                  memory: "Your decision to stay in the Philippines earned you community respect.",
                  category: "community",
                  importance: 3,
                  relationships: [{ id: "kapitbahay", change: +15 }],
                  unlockAchievement: "community_pillar"
                }
              ]
            },
            {
              text: "Negotiate for a remote work arrangement or shorter contract.",
              culturalContext: "This represents diskarte (resourcefulness) in finding a middle path that balances opportunities and obligations.",
              outcome: "You secure a modified arrangement that allows you to work abroad while maintaining stronger family connections.",
              stats: { finances: +15, happiness: +5, relationships: -5, career: +10 },
              skills: { negotiation: +20, adaptability: +15, technical: +5 },
              culturalValues: { diskarte: +20, familyPiety: +5 },
              memory: "You negotiated a balanced work arrangement that let you advance your career while maintaining family connections.",
              category: "career",
              importance: 4,
              emotion: "💻",
              relationships: [{ id: "family", change: -5 }]
            },
            {
              text: "Counter-propose by starting a local business with family involvement.",
              culturalContext: "This embodies Filipino entrepreneurial spirit and family collaboration.",
              outcome: "You take a risk and start a family business. It's challenging but keeps everyone together and working toward a common goal.",
              stats: { finances: -15, happiness: +10, relationships: +15, career: +5 },
              skills: { leadership: +15, creativity: +10, management: +15 },
              culturalValues: { bayanihan: +15, diskarte: +15, kapwa: +10 },
              memory: "You started a family business instead of working abroad.",
              category: "career",
              importance: 5,
              emotion: "🏪",
              relationships: [{ id: "family", change: +15 }],
              randomEvent: {
                chance: 0.3,
                event: {
                  text: "Your family business thrives beyond expectations, becoming a local success story!",
                  stats: { finances: +25, happiness: +15, career: +15 },
                  memory: "Your family business became unexpectedly successful.",
                  category: "career",
                  importance: 5,
                  emotion: "💰",
                  relationships: [{ id: "family", change: +10 }],
                  unlockAchievement: "entrepreneur"
                }
              }
            }
          ]
        },
        {
          id: "typhoon-aftermath",
          text: "A powerful typhoon has devastated your community. You have a critical work deadline, but neighbors need help with clean-up. What do you do?",
          culturalContext: "Natural disasters are common in the Philippines, and the bayanihan spirit (community cooperation) is especially important during these times.",
          choices: [
            {
              text: "Postpone work and fully commit to community clean-up efforts.",
              culturalContext: "This embodies the bayanihan spirit that is central to Filipino disaster response.",
              outcome: "You miss your deadline but become a key figure in the community recovery. Your neighbors are deeply grateful for your help.",
              stats: { finances: -15, happiness: +10, relationships: +25, career: -10 },
              skills: { social: +15, resilience: +10, leadership: +15 },
              culturalValues: { bayanihan: +25, pakikisama: +15, kapwa: +20 },
              memory: "You prioritized helping your community recover from the typhoon over your work deadline.",
              category: "community",
              importance: 4,
              emotion: "🤝",
              relationships: [{ id: "kapitbahay", change: +25 }, { id: "mentor", change: -10 }],
              unlockAchievement: "bayanihan",
              pendingConsequences: [
                {
                  triggerAge: 35,
                  text: "Years later, when you face a personal crisis, the entire community rallies to support you.",
                  stats: { relationships: +15, happiness: +10 },
                  memory: "Your community supported you in your time of need, remembering your help after the typhoon.",
                  category: "community",
                  importance: 4,
                  relationships: [{ id: "kapitbahay", change: +15 }]
                }
              ]
            },
            {
              text: "Focus on your deadline but donate money for relief efforts.",
              culturalContext: "This represents a more urban/modern approach that substitutes financial contribution for personal involvement.",
              outcome: "You complete your work successfully and your financial contribution helps, but some neighbors note your physical absence.",
              stats: { finances: -10, happiness: 0, relationships: -5, career: +15 },
              skills: { technical: +10, resilience: +5 },
              culturalValues: { bayanihan: -5, pakikisama: -10, kapwa: -5 },
              memory: "You focused on your work deadline during the typhoon aftermath, contributing financially instead.",
              category: "career",
              importance: 3,
              emotion: "💵",
              relationships: [{ id: "kapitbahay", change: -10 }, { id: "mentor", change: +10 }]
            },
            {
              text: "Split your time, helping during the day and working late nights to meet your deadline.",
              culturalContext: "This represents the Filipino value of pagtitiis (endurance/sacrifice) to fulfill multiple obligations.",
              outcome: "You manage to help with the clean-up and complete your work, though the lack of sleep takes a toll on your health.",
              stats: { finances: 0, happiness: +5, relationships: +15, career: +5, health: -15 },
              skills: { resilience: +20, adaptability: +15, technical: +5 },
              culturalValues: { bayanihan: +15, pagiging_masipag: +20, pagiging_matiisin: +15 },
              memory: "You sacrificed your rest to both help with typhoon clean-up and meet your work deadline.",
              category: "personal",
              importance: 3,
              emotion: "😴",
              relationships: [{ id: "kapitbahay", change: +15 }, { id: "mentor", change: +5 }]
            },
            {
              text: "Negotiate with your boss for an extension, explaining the community emergency.",
              culturalContext: "This uses diskarte (resourcefulness) to find a solution that honors both obligations.",
              outcome: "Your boss grants a short extension. You're able to help significantly with clean-up while still completing your work.",
              stats: { finances: 0, happiness: +10, relationships: +15, career: 0 },
              skills: { negotiation: +15, social: +10, leadership: +5 },
              culturalValues: { bayanihan: +15, diskarte: +20 },
              memory: "You negotiated a work extension to help with typhoon recovery efforts.",
              category: "community",
              importance: 3,
              emotion: "🗣️",
              relationships: [{ id: "kapitbahay", change: +15 }, { id: "mentor", change: +5 }]
            }
          ]
        },
        {
          id: "utang-na-loob-dilemma",
          text: "Your ninong, who paid for your college education, asks you to hire his unqualified son at your company. What do you do?",
          culturalContext: "Utang na loob (debt of gratitude) creates complex obligations in Filipino culture, especially toward those who have significantly helped you.",
          choices: [
            {
              text: "Hire his son despite his lack of qualifications.",
              culturalContext: "This prioritizes utang na loob over professional ethics - a traditional but problematic approach.",
              outcome: "You honor your debt to your ninong, but your professional reputation suffers as his son struggles in the role.",
              stats: { finances: -5, happiness: -5, relationships: +10, career: -15 },
              skills: { leadership: -5, management: -5 },
              culturalValues: { utangNaLoob: +25, delicadeza: -15, hiya: +10 },
              memory: "You prioritized utang na loob by hiring your ninong's unqualified son.",
              category: "career",
              importance: 4,
              emotion: "😬",
              relationships: [{ id: "ninong", change: +25 }, { id: "mentor", change: -15 }],
              pendingConsequences: [
                {
                  triggerAge: 35,
                  text: "Your decision to hire your ninong's unqualified son has had lasting negative effects on your career.",
                  stats: { career: -10 },
                  memory: "Your colleagues still question your judgment after hiring your ninong's unqualified son.",
                  category: "career",
                  importance: 3,
                  relationships: [{ id: "mentor", change: -10 }]
                }
              ]
            },
            {
              text: "Politely decline but offer to mentor his son instead.",
              culturalContext: "This balances utang na loob with professional integrity through an alternative form of help.",
              outcome: "You find a middle ground that acknowledges your debt while maintaining your professional integrity.",
              stats: { finances: 0, happiness: +5, relationships: +5, career: +5 },
              skills: { negotiation: +10, leadership: +10, teaching: +15 },
              culturalValues: { utangNaLoob: +10, delicadeza: +15 },
              memory: "You balanced utang na loob with professional integrity by offering to mentor your ninong's son instead of hiring him.",
              category: "career",
              importance: 3,
              emotion: "🧠",
              relationships: [{ id: "ninong", change: +10 }, { id: "mentor", change: +5 }]
            },
            {
              text: "Explain that you can't hire him but help him find a more suitable position elsewhere.",
              culturalContext: "This uses diskarte (resourcefulness) to fulfill the obligation in an alternative way.",
              outcome: "You maintain your professional standards while still showing gratitude to your ninong by helping his son in other ways.",
              stats: { finances: 0, happiness: +10, relationships: 0, career: +10 },
              skills: { negotiation: +5, networking: +15 },
              culturalValues: { utangNaLoob: +5, delicadeza: +20, diskarte: +15 },
              memory: "You honored your professional standards while still helping your ninong's son find suitable employment elsewhere.",
              category: "career",
              importance: 3,
              emotion: "🔍",
              relationships: [{ id: "ninong", change: 0 }, { id: "mentor", change: +10 }]
            },
            {
              text: "Create a probationary position with clear performance expectations.",
              culturalContext: "This represents a compromise that gives an opportunity while maintaining standards.",
              outcome: "You give his son a chance to prove himself, with the understanding that continued employment depends on performance.",
              stats: { finances: -5, happiness: 0, relationships: +5, career: -5 },
              skills: { leadership: +10, management: +10, teaching: +5 },
              culturalValues: { utangNaLoob: +15, delicadeza: +5, diskarte: +10 },
              memory: "You created a probationary position for your ninong's son with clear performance expectations.",
              category: "career",
              importance: 3,
              emotion: "⚖️",
              relationships: [{ id: "ninong", change: +15 }, { id: "mentor", change: -5 }],
              randomEvent: {
                chance: 0.5,
                event: {
                  text: "Surprisingly, your ninong's son rises to the challenge and becomes a valuable team member.",
                  stats: { happiness: +10, relationships: +10, career: +10 },
                  memory: "Your ninong's son exceeded expectations and became a valuable employee.",
                  category: "career",
                  importance: 4,
                  emotion: "🌟",
                  relationships: [{ id: "ninong", change: +10 }, { id: "mentor", change: +10 }]
                }
              }
            }
          ]
        },
        {
          id: "fiesta-celebration",
          text: "Your barangay's annual fiesta is approaching. As a respected community member, you're expected to contribute. How will you participate?",
          culturalContext: "Fiestas are major cultural events in the Philippines, with participation reflecting one's standing and integration in the community.",
          choices: [
            {
              text: "Volunteer to organize the cultural performances and games.",
              culturalContext: "This demonstrates leadership in preserving cultural traditions and community involvement.",
              outcome: "Your leadership in organizing the cultural aspects of the fiesta earns you respect and strengthens your community ties.",
              stats: { finances: -5, happiness: +15, relationships: +20, health: -5 },
              skills: { leadership: +15, social: +10, creativity: +10, management: +15 },
              culturalValues: { bayanihan: +15, pakikisama: +20, kapwa: +15 },
              memory: "You took a leadership role in organizing the barangay fiesta cultural events.",
              category: "community",
              importance: 3,
              emotion: "🎭",
              relationships: [{ id: "kapitbahay", change: +20 }, { id: "parish_community", change: +15 }],
              unlockAchievement: "fiesta_host"
            },
            {
              text: "Prepare a large amount of traditional food to share with neighbors.",
              culturalContext: "Food sharing is central to Filipino celebrations and community bonding.",
              outcome: "Your lechon and pancit are the talk of the fiesta! Everyone appreciates your generosity and cooking skills.",
              stats: { finances: -15, happiness: +10, relationships: +15, health: 0 },
              skills: { cooking: +20, social: +5 },
              culturalValues: { pakikisama: +15, pagiging_masipag: +10, kapwa: +10 },
              memory: "Your traditional Filipino dishes were a highlight of the barangay fiesta.",
              category: "community",
              importance: 2,
              emotion: "🍲",
              relationships: [{ id: "kapitbahay", change: +15 }, { id: "suki", change: +10 }],
              addInventory: "cookbook"
            },
            {
              text: "Sponsor the cash prizes for the competitions.",
              culturalContext: "Financial contribution is a way for busier or more affluent community members to participate.",
              outcome: "Your financial contribution is acknowledged during the fiesta, earning you status in the community.",
              stats: { finances: -25, happiness: +5, relationships: +10, career: +5 },
              skills: { leadership: +5 },
              culturalValues: { delicadeza: +10, respeto: +5 },
              memory: "You sponsored the prizes for the barangay fiesta competitions.",
              category: "community",
              importance: 2,
              emotion: "💰",
              relationships: [{ id: "kapitbahay", change: +10 }]
            },
            {
              text: "Organize a health and wellness component for the fiesta.",
              culturalContext: "This represents a modern addition to traditional celebrations, blending cultural preservation with contemporary needs.",
              outcome: "Your innovative addition to the fiesta is appreciated, especially by the elderly and health-conscious community members.",
              stats: { finances: -10, happiness: +10, relationships: +15, health: +10 },
              skills: { leadership: +10, creativity: +15, teaching: +10 },
              culturalValues: { bayanihan: +10, diskarte: +15, kapwa: +10 },
              memory: "You introduced a successful health and wellness component to the traditional barangay fiesta.",
              category: "community",
              importance: 3,
              emotion: "❤️",
              relationships: [{ id: "kapitbahay", change: +15 }, { id: "lola", change: +10 }],
              pendingConsequences: [
                {
                  triggerAge: 40,
                  text: "Your health initiative has become a permanent part of the annual fiesta, improving community wellness.",
                  stats: { relationships: +10, happiness: +5, health: +5 },
                  memory: "Your fiesta health initiative became a valued community tradition.",
                  category: "community",
                  importance: 3,
                  relationships: [{ id: "kapitbahay", change: +10 }],
                  unlockAchievement: "community_pillar"
                }
              ]
            }
          ]
        },
        {
          id: "pakikisama-workplace",
          text: "Your coworkers regularly go out for after-work drinks and karaoke. You're tired and would prefer to go home, but they insist you join them tonight. What do you do?",
          culturalContext: "Pakikisama (getting along/harmony) in workplace relationships is highly valued in Filipino professional culture, often blurring work-life boundaries.",
          choices: [
            {
              text: "Join them to maintain good pakikisama (harmony) with colleagues.",
              culturalContext: "This prioritizes workplace harmony and social bonds over personal needs - a common Filipino approach.",
              outcome: "Despite your tiredness, you enjoy the evening. Your relationship with coworkers strengthens, which could benefit your career.",
              stats: { finances: -5, happiness: +5, relationships: +15, career: +10, health: -5 },
              skills: { social: +10 },
              culturalValues: { pakikisama: +20, hiya: -5 },
              memory: "You prioritized pakikisama by joining colleagues for karaoke despite being tired.",
              category: "career",
              importance: 2,
              emotion: "🎤",
              relationships: [{ id: "mentor", change: +10 }]
            },
            {
              text: "Politely decline and explain you need rest tonight.",
              culturalContext: "This prioritizes personal needs over social expectations - a more Western approach that can be seen as lacking pakikisama.",
              outcome: "You get needed rest but miss an opportunity to bond with colleagues. Some understand, but others think you're not a team player.",
              stats: { finances: +5, happiness: +5, relationships: -5, career: -5, health: +10 },
              skills: { resilience: +5 },
              culturalValues: { pakikisama: -10, hiya: +5, delicadeza: +5, amor_propio: +10 },
              memory: "You chose personal well-being over pakikisama when declining a work social event.",
              category: "career",
              importance: 1,
              emotion: "🛌",
              relationships: [{ id: "mentor", change: -5 }]
            },
            {
              text: "Join briefly to show face then excuse yourself early.",
              culturalContext: "This represents a compromise that acknowledges both pakikisama and personal needs - a balanced approach.",
              outcome: "You find a middle ground that allows you to maintain relationships while also taking care of yourself.",
              stats: { finances: -3, happiness: +3, relationships: +5, career: +5, health: 0 },
              skills: { social: +5, negotiation: +10 },
              culturalValues: { pakikisama: +10, delicadeza: +10, diskarte: +5 },
              memory: "You balanced pakikisama and personal needs by briefly attending the work gathering.",
              category: "career",
              importance: 1,
              emotion: "⏱️",
              relationships: [{ id: "mentor", change: +5 }]
            },
            {
              text: "Suggest an alternative activity that requires less energy but still builds camaraderie.",
              culturalContext: "This uses diskarte (resourcefulness) to maintain pakikisama while accommodating personal needs.",
              outcome: "Your suggestion of a quick coffee instead of karaoke is well-received. You build relationships in a more manageable way.",
              stats: { finances: -3, happiness: +8, relationships: +10, career: +5, health: +5 },
              skills: { social: +10, negotiation: +10, leadership: +5 },
              culturalValues: { pakikisama: +15, diskarte: +15 },
              memory: "You suggested a more relaxed alternative to karaoke that still built team camaraderie.",
              category: "career",
              importance: 2,
              emotion: "☕",
              relationships: [{ id: "mentor", change: +10 }],
              pendingConsequences: [
                {
                  triggerAge: 35,
                  text: "Your ability to suggest alternatives that meet everyone's needs has made you a respected mediator at work.",
                  stats: { career: +10, relationships: +5 },
                  memory: "Your balanced approach to workplace social dynamics earned you respect as a mediator.",
                  category: "career",
                  importance: 2,
                  relationships: [{ id: "mentor", change: +5 }]
                }
              ]
            }
          ]
        }
      ],
      
      // Middle Age (41-60)
      middleAge: [
        {
          id: "caring-for-elderly-parents",
          text: "Your elderly parents need increasing care. Your siblings suggest hiring a caregiver, but traditional values suggest children should care for parents directly. What do you do?",
          culturalContext: "Caring for elderly parents is a core Filipino value (utang na loob), but modern life creates practical challenges for traditional caregiving approaches.",
          choices: [
            {
              text: "Move your parents into your home to care for them personally.",
              culturalContext: "This traditional approach fulfills the Filipino value of caring for elderly parents directly.",
              outcome: "You adjust your life to accommodate your parents' needs. It's challenging but strengthens your family bonds.",
              stats: { finances: -15, happiness: +5, relationships: +20, career: -10, health: -5 },
              skills: { resilience: +15, adaptability: +10 },
              culturalValues: { utangNaLoob: +25, familyPiety: +25, respeto: +20 },
              memory: "You took your elderly parents into your home to care for them personally.",
              category: "family",
              importance: 5,
              emotion: "👴👵",
              relationships: [{ id: "family", change: +25 }, { id: "lola", change: +20 }],
              unlockAchievement: "family_first",
              pendingConsequences: [
                {
                  triggerAge: 50,
                  text: "Your children have learned from your example and promise to care for you in your old age.",
                  stats: { happiness: +15, relationships: +10 },
                  memory: "Your children promised to care for you in old age, following your example.",
                  category: "family",
                  importance: 4,
                  relationships: [{ id: "family", change: +10 }],
                  unlockAchievement: "family_legacy"
                }
              ]
            },
            {
              text: "Hire a professional caregiver but visit frequently.",
              culturalContext: "This modern approach balances filial responsibility with practical realities.",
              outcome: "Your parents receive professional care while you maintain regular involvement. It's a practical compromise.",
              stats: { finances: -25, happiness: 0, relationships: +5, career: 0 },
              skills: { management: +10 },
              culturalValues: { utangNaLoob: +5, familyPiety: +5, diskarte: +10 },
              memory: "You arranged professional care for your parents while staying involved in their lives.",
              category: "family",
              importance: 4,
              emotion: "👩‍⚕️",
              relationships: [{ id: "family", change: +5 }]
            },
            {
              text: "Rotate care responsibilities among siblings.",
              culturalContext: "This collaborative approach reflects bayanihan (community spirit) within the family unit.",
              outcome: "Your family shares the caregiving responsibilities. It strengthens sibling bonds and ensures your parents receive family care.",
              stats: { finances: -10, happiness: +5, relationships: +15, career: -5 },
              skills: { negotiation: +10, management: +10 },
              culturalValues: { utangNaLoob: +15, familyPiety: +15, bayanihan: +20 },
              memory: "You organized a family care rotation for your elderly parents.",
              category: "family",
              importance: 4,
              emotion: "👨‍👩‍👧‍👦",
              relationships: [{ id: "family", change: +15 }]
            },
            {
              text: "Create a hybrid solution with part-time care and family involvement.",
              culturalContext: "This represents diskarte (resourcefulness) in finding a balanced solution that honors values while acknowledging realities.",
              outcome: "You develop a comprehensive care plan that combines professional help with family involvement. It's sustainable and respectful.",
              stats: { finances: -20, happiness: +10, relationships: +10, career: -5 },
              skills: { negotiation: +15, management: +15, adaptability: +10 },
              culturalValues: { utangNaLoob: +10, familyPiety: +10, diskarte: +20 },
              memory: "You created a balanced care plan for your parents combining professional and family care.",
              category: "family",
              importance: 4,
              emotion: "🤹",
              relationships: [{ id: "family", change: +10 }],
              unlockAchievement: "balanced_life"
            }
          ]
        },
        {
          id: "community-leadership",
          text: "Your barangay is facing increasing problems with waste management and flooding. The current leadership seems ineffective. What role do you take?",
          culturalContext: "Community involvement is highly valued in Filipino culture, with an expectation that successful individuals will contribute to community welfare.",
          choices: [
            {
              text: "Run for barangay captain to implement systematic changes.",
              culturalContext: "This represents taking formal leadership responsibility for community welfare - a respected but demanding role.",
              outcome: "You campaign and win the position. The responsibility is significant, but you're able to implement meaningful improvements.",
              stats: { finances: -10, happiness: +10, relationships: +15, career: -5, health: -10 },
              skills: { leadership: +25, management: +20, negotiation: +15 },
              culturalValues: { bayanihan: +25, kapwa: +20, delicadeza: +15 },
              memory: "You became barangay captain to address community environmental problems.",
              category: "community",
              importance: 5,
              emotion: "🏛️",
              relationships: [{ id: "kapitbahay", change: +25 }],
              unlockAchievement: "community_pillar",
              pendingConsequences: [
                {
                  triggerAge: 55,
                  text: "Your successful community leadership has inspired younger residents to become more civically engaged.",
                  stats: { happiness: +15, relationships: +10 },
                  memory: "Your community leadership inspired a new generation of civic engagement.",
                  category: "community",
                  importance: 4,
                  relationships: [{ id: "kapitbahay", change: +10 }],
                  unlockAchievement: "family_legacy"
                }
              ]
            },
            {
              text: "Organize a community bayanihan effort without seeking official position.",
              culturalContext: "This embodies the bayanihan spirit of community cooperation without formal authority.",
              outcome: "You mobilize neighbors for regular clean-up drives and small infrastructure improvements. The community spirit strengthens.",
              stats: { finances: -5, happiness: +15, relationships: +20, career: 0, health: -5 },
              skills: { leadership: +15, social: +20 },
              culturalValues: { bayanihan: +25, pakikisama: +15, kapwa: +15 },
              memory: "You organized community bayanihan efforts to address local environmental issues.",
              category: "community",
              importance: 4,
              emotion: "🤝",
              relationships: [{ id: "kapitbahay", change: +20 }],
              unlockAchievement: "bayanihan"
            },
            {
              text: "Contribute financially to improvement projects but limit personal involvement.",
              culturalContext: "This represents a more detached but still supportive approach to community welfare.",
              outcome: "Your financial contributions enable some improvements, though implementation is sometimes inefficient without your oversight.",
              stats: { finances: -20, happiness: +5, relationships: +5, career: +5 },
              skills: { negotiation: +5 },
              culturalValues: { bayanihan: +5, delicadeza: +10 },
              memory: "You financially supported community improvement projects from a distance.",
              category: "community",
              importance: 2,
              emotion: "💵",
              relationships: [{ id: "kapitbahay", change: +5 }]
            },
            {
              text: "Use your professional expertise to develop solutions and train community members.",
              culturalContext: "This represents sharing knowledge and skills for community benefit - a valued form of contribution.",
              outcome: "You develop effective systems and train local youth to implement and maintain them. Your approach creates sustainable change.",
              stats: { finances: -5, happiness: +15, relationships: +15, career: +5 },
              skills: { teaching: +20, leadership: +10, technical: +15 },
              culturalValues: { bayanihan: +15, kapwa: +10, diskarte: +20 },
              memory: "You used your expertise to develop sustainable solutions for community environmental problems.",
              category: "community",
              importance: 4,
              emotion: "🧠",
              relationships: [{ id: "kapitbahay", change: +15 }, { id: "mentor", change: +10 }],
              unlockAchievement: "cultural_pride"
            }
          ]
        },
        {
          id: "cultural-preservation",
          text: "You notice traditional Filipino practices and values are fading in your community, especially among youth. How do you respond?",
          culturalContext: "Cultural preservation is a growing concern in the Philippines as globalization and technology influence younger generations.",
          choices: [
            {
              text: "Establish a cultural education program for local youth.",
              culturalContext: "This represents active intervention to preserve cultural heritage through education.",
              outcome: "Your program successfully engages many young people in learning traditional arts, language, and values.",
              stats: { finances: -15, happiness: +15, relationships: +15, career: 0 },
              skills: { teaching: +20, creativity: +15, leadership: +10 },
              culturalValues: { kapwa: +15, respeto: +15, faith: +10 },
              memory: "You established a successful cultural education program for youth in your community.",
              category: "community",
              importance: 4,
              emotion: "🏫",
              relationships: [{ id: "kapitbahay", change: +15 }, { id: "parish_community", change: +10 }],
              unlockAchievement: "cultural_pride",
              pendingConsequences: [
                {
                  triggerAge: 60,
                  text: "Your cultural program has grown into a respected institution that attracts visitors from other regions.",
                  stats: { happiness: +15, relationships: +10 },
                  memory: "Your cultural preservation program became a regional attraction.",
                  category: "community",
                  importance: 4,
                  relationships: [{ id: "kapitbahay", change: +10 }],
                  unlockAchievement: "family_legacy"
                }
              ]
            },
            {
              text: "Document traditions through recordings, recipes, and stories.",
              culturalContext: "This represents preservation through documentation rather than active teaching.",
              outcome: "You create a valuable archive of local cultural practices that might otherwise be lost to time.",
              stats: { finances: -10, happiness: +10, relationships: +5, career: +5 },
              skills: { creativity: +15, technical: +10 },
              culturalValues: { kapwa: +10, respeto: +10 },
              memory: "You documented local cultural traditions through various media.",
              category: "community",
              importance: 3,
              emotion: "📚",
              relationships: [{ id: "lola", change: +15 }, { id: "kapitbahay", change: +5 }],
              addInventory: "cookbook"
            },
            {
              text: "Adapt traditions into modern formats that appeal to youth.",
              culturalContext: "This represents cultural evolution rather than strict preservation - finding the essence of traditions that can survive in modern contexts.",
              outcome: "Your innovative approach successfully engages youth by making traditions relevant to contemporary life.",
              stats: { finances: -5, happiness: +15, relationships: +10, career: +5 },
              skills: { creativity: +20, adaptability: +15, technical: +10 },
              culturalValues: { kapwa: +10, diskarte: +20 },
              memory: "You successfully modernized traditional practices to engage Filipino youth.",
              category: "community",
              importance: 4,
              emotion: "🔄",
              relationships: [{ id: "kapitbahay", change: +10 }, { id: "barkada", change: +15 }],
              unlockAchievement: "cultural_pride"
            },
            {
              text: "Focus on preserving specific traditions that are most at risk.",
              culturalContext: "This represents a targeted approach to cultural preservation, focusing resources on the most endangered elements.",
              outcome: "Your focused efforts save specific traditions from disappearing, though broader cultural shifts continue.",
              stats: { finances: -10, happiness: +10, relationships: +10, career: 0 },
              skills: { teaching: +15, creativity: +10 },
              culturalValues: { kapwa: +15, respeto: +15 },
              memory: "You successfully preserved specific endangered Filipino traditions in your community.",
              category: "community",
              importance: 3,
              emotion: "🧵",
              relationships: [{ id: "lola", change: +20 }, { id: "kapitbahay", change: +10 }],
              addInventory: "kakanin_recipe"
            }
          ]
        },
        {
          id: "retirement-planning",
          text: "As you approach retirement age, you need to make decisions about your future living arrangements and financial planning. What do you prioritize?",
          culturalContext: "Filipino retirement often involves family-based support systems rather than institutional care, with expectations that children will care for elderly parents.",
          choices: [
            {
              text: "Plan to live with your children, following Filipino tradition.",
              culturalContext: "This represents the traditional Filipino approach to elder care within the family unit.",
              outcome: "You prepare to move in with your children when needed. This strengthens family bonds but creates some dependency.",
              stats: { finances: +10, happiness: +5, relationships: +15, health: +5 },
              skills: { adaptability: +10 },
              culturalValues: { familyPiety: +20, utangNaLoob: +15, kapwa: +10 },
              memory: "You chose to follow the traditional Filipino approach of living with your children in retirement.",
              category: "family",
              importance: 4,
              emotion: "👨‍👩‍👧",
              relationships: [{ id: "family", change: +15 }]
            },
            {
              text: "Invest in an independent retirement home but stay near family.",
              culturalContext: "This represents a more Western approach to retirement that maintains independence while keeping family connections.",
              outcome: "You secure a comfortable retirement home near your family, allowing for both independence and regular interaction.",
              stats: { finances: -25, happiness: +15, relationships: +5, health: +10 },
              skills: { management: +15 },
              culturalValues: { familyPiety: +5, amor_propio: +15 },
              memory: "You chose an independent retirement arrangement while staying close to family.",
              category: "personal",
              importance: 4,
              emotion: "🏡",
              relationships: [{ id: "family", change: +5 }]
            },
            {
              text: "Return to your provincial hometown for retirement.",
              culturalContext: "This represents a common Filipino pattern of urban-to-rural return migration in later life.",
              outcome: "You return to your roots, reconnecting with old community ties and enjoying a simpler, less expensive lifestyle.",
              stats: { finances: +15, happiness: +10, relationships: +10, health: +15 },
              skills: { adaptability: +15, social: +10 },
              culturalValues: { kapwa: +15, faith: +10, bayanihan: +10 },
              memory: "You returned to your provincial hometown for retirement.",
              category: "community",
              importance: 4,
              emotion: "🌱",
              relationships: [{ id: "kapitbahay", change: +15 }, { id: "parish_community", change: +10 }]
            },
            {
              text: "Create a multi-generational living arrangement on shared property.",
              culturalContext: "This represents a hybrid approach that maintains both family connections and independence.",
              outcome: "You develop a family compound with separate living spaces that allows for both privacy and close family support.",
              stats: { finances: -20, happiness: +15, relationships: +15, health: +10 },
              skills: { management: +10, negotiation: +15, leadership: +10 },
              culturalValues: { familyPiety: +15, diskarte: +15, kapwa: +15 },
              memory: "You created a multi-generational family living arrangement for your retirement.",
              category: "family",
              importance: 5,
              emotion: "🏘️",
              relationships: [{ id: "family", change: +15 }],
              unlockAchievement: "balanced_life"
            }
          ]
        }
      ],
      
      // Senior (61+)
      senior: [
        {
          id: "legacy-reflection",
          text: "As you reflect on your life, what do you consider your greatest source of pride and fulfillment?",
          culturalContext: "Life reflection in Filipino culture often centers on family legacy, community contribution, and spiritual fulfillment rather than individual achievement.",
          choices: [
            {
              text: "The family you've raised and the values you've passed on.",
              culturalContext: "This reflects the central importance of family in Filipino conceptions of a successful life.",
              outcome: "You find deep satisfaction in seeing your children and grandchildren embody the values you've taught them.",
              stats: { happiness: +25, relationships: +20 },
              skills: { teaching: +15 },
              culturalValues: { familyPiety: +25, utangNaLoob: +15, kapwa: +15 },
              memory: "You found greatest fulfillment in your family legacy and the values you passed on.",
              category: "family",
              importance: 5,
              emotion: "👨‍👩‍👧‍👦",
              relationships: [{ id: "family", change: +20 }],
              unlockAchievement: "family_legacy"
            },
            {
              text: "Your career achievements and contributions.",
              culturalContext: "This reflects a more Western/individualistic measure of life success, though still valued in modern Filipino society.",
              outcome: "You take pride in your professional accomplishments and the impact you've made in your field.",
              stats: { happiness: +20, career: +25 },
              skills: { technical: +15, leadership: +10 },
              culturalValues: { pagiging_masipag: +15, amor_propio: +15 },
              memory: "You found greatest satisfaction in your career achievements and contributions.",
              category: "career",
              importance: 4,
              emotion: "💼",
              relationships: [{ id: "mentor", change: +20 }]
            },
            {
              text: "The ways you've helped your community.",
              culturalContext: "This reflects the Filipino value of bayanihan and community service as a measure of a life well-lived.",
              outcome: "You find meaning in the positive difference you've made in your community and society.",
              stats: { happiness: +25, relationships: +15 },
              skills: { social: +15, leadership: +10 },
              culturalValues: { bayanihan: +30, pakikisama: +20, kapwa: +25 },
              memory: "You found greatest meaning in your contributions to community and society.",
              category: "community",
              importance: 5,
              emotion: "🤝",
              relationships: [{ id: "kapitbahay", change: +25 }],
              unlockAchievement: "community_pillar"
            },
            {
              text: "The personal growth and wisdom you've gained.",
              culturalContext: "This reflects a more spiritual/philosophical measure of life success that resonates with Filipino religious values.",
              outcome: "You appreciate the inner journey of self-discovery and the wisdom you've accumulated.",
              stats: { happiness: +30, spirituality: +25 },
              skills: { resilience: +25, creativity: +15 },
              culturalValues: { faith: +20, pagiging_matiisin: +15, amor_propio: +10 },
              memory: "You found greatest peace in your personal growth and wisdom.",
              category: "spiritual",
              importance: 5,
              emotion: "🧘",
              relationships: [{ id: "mentor", change: +15 }, { id: "parish_community", change: +15 }],
              unlockAchievement: "balanced_life"
            }
          ]
        },
        {
          id: "passing-traditions",
          text: "You possess knowledge of traditional Filipino practices, recipes, or stories. How do you ensure these are preserved for future generations?",
          culturalContext: "Cultural transmission is a significant concern for Filipino elders, who often see themselves as guardians of traditional knowledge.",
          choices: [
            {
              text: "Teach your grandchildren through regular hands-on sessions.",
              culturalContext: "This represents direct intergenerational transmission - the traditional method of cultural preservation.",
              outcome: "Your grandchildren develop a deep appreciation for their heritage through your patient teaching.",
              stats: { happiness: +20, relationships: +25 },
              skills: { teaching: +20, cooking: +15 },
              culturalValues: { kapwa: +20, respeto: +15, faith: +10 },
              memory: "You passed on traditional Filipino knowledge directly to your grandchildren.",
              category: "family",
              importance: 5,
              emotion: "👵👦",
              relationships: [{ id: "family", change: +25 }],
              unlockAchievement: "cultural_pride",
              addInventory: "kakanin_recipe"
            },
            {
              text: "Document everything in writing, photos, and videos.",
              culturalContext: "This represents a modern approach to cultural preservation through documentation.",
              outcome: "You create a comprehensive archive of cultural knowledge that can be shared widely and preserved indefinitely.",
              stats: { happiness: +15, relationships: +10 },
              skills: { creativity: +15, technical: +10 },
              culturalValues: { kapwa: +15, diskarte: +10 },
              memory: "You documented traditional Filipino knowledge through various media for preservation.",
              category: "community",
              importance: 4,
              emotion: "📹",
              relationships: [{ id: "family", change: +10 }, { id: "kapitbahay", change: +15 }],
              unlockAchievement: "cultural_pride",
              addInventory: "cookbook"
            },
            {
              text: "Organize community workshops and cultural events.",
              culturalContext: "This represents community-based cultural preservation that extends beyond family.",
              outcome: "Your workshops become popular, spreading cultural knowledge throughout the community and to visitors.",
              stats: { happiness: +20, relationships: +20, health: -10 },
              skills: { teaching: +15, leadership: +15, social: +10 },
              culturalValues: { bayanihan: +20, kapwa: +15, pakikisama: +10 },
              memory: "You organized community workshops to preserve and share Filipino cultural traditions.",
              category: "community",
              importance: 5,
              emotion: "🎭",
              relationships: [{ id: "kapitbahay", change: +20 }, { id: "parish_community", change: +15 }],
              unlockAchievement: "community_pillar"
            },
            {
              text: "Collaborate with local schools or cultural institutions.",
              culturalContext: "This represents institutional cultural preservation that formalizes traditional knowledge.",
              outcome: "Your knowledge becomes part of formal educational programs, ensuring systematic preservation and transmission.",
              stats: { happiness: +15, relationships: +15 },
              skills: { teaching: +20, negotiation: +10 },
              culturalValues: { kapwa: +15, diskarte: +15 },
              memory: "You worked with institutions to incorporate Filipino traditions into formal education.",
              category: "community",
              importance: 4,
              emotion: "🏫",
              relationships: [{ id: "kapitbahay", change: +15 }, { id: "mentor", change: +10 }],
              unlockAchievement: "cultural_pride"
            }
          ]
        },
        {
          id: "health-challenge",
          text: "You're facing a significant health challenge that requires ongoing treatment. How do you approach your care?",
          culturalContext: "Health challenges in Filipino culture are often addressed through a combination of modern medicine, family care, and spiritual/traditional practices.",
          choices: [
            {
              text: "Rely primarily on family caregiving with medical supervision.",
              culturalContext: "This represents the traditional Filipino approach of family-based elder care during illness.",
              outcome: "Your family provides loving care, though it creates some burden on them. The familiar environment supports your emotional well-being.",
              stats: { happiness: +10, relationships: +15, health: +5 },
              skills: { resilience: +10 },
              culturalValues: { familyPiety: +20, utangNaLoob: +15, faith: +10 },
              memory: "You chose family-based care during your health challenge.",
              category: "health",
              importance: 4,
              emotion: "👨‍👩‍👧",
              relationships: [{ id: "family", change: +15 }]
            },
            {
              text: "Seek the most advanced medical treatment available.",
              culturalContext: "This represents a more Western/modern approach that prioritizes medical expertise over traditional practices.",
              outcome: "You receive excellent technical care, though the clinical environment sometimes feels impersonal.",
              stats: { finances: -30, happiness: 0, health: +25 },
              skills: { resilience: +15 },
              culturalValues: { diskarte: +15, amor_propio: +10 },
              memory: "You prioritized advanced medical treatment for your health challenge.",
              category: "health",
              importance: 4,
              emotion: "🏥",
              relationships: [{ id: "family", change: -5 }]
            },
            {
              text: "Combine medical treatment with traditional healing practices.",
              culturalContext: "This represents the common Filipino approach of medical pluralism - using both modern and traditional healing systems.",
              outcome: "Your integrated approach addresses both physical and spiritual aspects of healing, providing comprehensive care.",
              stats: { finances: -15, happiness: +15, health: +15, spirituality: +15 },
              skills: { resilience: +20, adaptability: +15 },
              culturalValues: { faith: +15, diskarte: +20, kapwa: +10 },
              memory: "You integrated modern medicine with traditional Filipino healing practices.",
              category: "health",
              importance: 5,
              emotion: "🌿",
              relationships: [{ id: "family", change: +10 }, { id: "parish_community", change: +15 }],
              addInventory: "anting_anting"
            },
            {
              text: "Focus on quality of life and spiritual preparation.",
              culturalContext: "This represents the Filipino approach to serious illness that emphasizes spiritual readiness and meaningful final experiences.",
              outcome: "You find peace through spiritual practices and meaningful time with loved ones, accepting the natural course of your condition.",
              stats: { happiness: +20, relationships: +20, health: -5, spirituality: +25 },
              skills: { resilience: +25 },
              culturalValues: { faith: +25, pagiging_matiisin: +20, kapwa: +15 },
              memory: "You focused on spiritual preparation and quality of life during your health challenge.",
              category: "spiritual",
              importance: 5,
              emotion: "🙏",
              relationships: [{ id: "family", change: +20 }, { id: "parish_community", change: +25 }],
              addInventory: "rosary"
            }
          ]
        }
      ]
    };

    // Random Events with Filipino cultural context
    const randomEvents = [
      {
        text: "You unexpectedly win a small lottery prize!",
        stats: { finances: +20, happiness: +15 },
        culturalValues: { diskarte: +5 },
        memory: "You won a small lottery prize.",
        category: "personal",
        importance: 2,
        emotion: "🎰"
      },
      {
        text: "A distant relative asks for financial help for their child's education.",
        stats: { finances: -15, relationships: +10, happiness: -5 },
        culturalValues: { utangNaLoob: +10, hiya: -5, familyPiety: +5 },
        memory: "You helped a distant relative with their child's education expenses.",
        category: "family",
        importance: 2,
        emotion: "🎓",
        relationships: [{ id: "family", change: +10 }]
      },
      {
        text: "You get scammed in a 'networking' investment scheme.",
        stats: { finances: -25, happiness: -15 },
        culturalValues: { hiya: +10 },
        memory: "You lost money in a networking investment scam.",
        category: "personal",
        importance: 3,
        emotion: "😞"
      },
      {
        text: "A friend offers you a job opportunity with better pay.",
        stats: { finances: +15, career: +10, happiness: +5 },
        culturalValues: { utangNaLoob: +10, pakikisama: +5 },
        memory: "A friend helped you find a better-paying job.",
        category: "career",
        importance: 3,
        emotion: "💼",
        relationships: [{ id: "barkada", change: +15 }]
      },
      {
        text: "You face unexpected medical expenses.",
        stats: { finances: -20, happiness: -10, health: -5 },
        memory: "You had to pay unexpected medical expenses.",
        category: "health",
        importance: 2,
        emotion: "💉"
      },
      {
        text: "Your barangay recognizes you for your community contributions.",
        stats: { happiness: +20, relationships: +15 },
        culturalValues: { bayanihan: +15, hiya: -10, amor_propio: +10 },
        memory: "Your barangay recognized you for your community contributions.",
        category: "community",
        importance: 3,
        emotion: "🏆",
        relationships: [{ id: "kapitbahay", change: +20 }]
      },
      {
        text: "A typhoon damages your property.",
        stats: { finances: -30, happiness: -15 },
        culturalValues: { pagiging_matiisin: +15, diskarte: +10 },
        memory: "Your property was damaged by a typhoon.",
        category: "personal",
        importance: 4,
        emotion: "🌪️"
      },
      {
        text: "You're invited to be a ninong/ninang (godparent) at a baptism.",
        stats: { finances: -10, relationships: +15, happiness: +10, spirituality: +5 },
        culturalValues: { pakikisama: +15, familyPiety: +10, faith: +10 },
        memory: "You became a ninong/ninang at a baptism.",
        category: "spiritual",
        importance: 3,
        emotion: "👶",
        relationships: [{ id: "family", change: +10 }, { id: "parish_community", change: +10 }]
      },
      {
        text: "A long-lost relative from abroad sends you a balikbayan box full of goods.",
        stats: { finances: +10, happiness: +15 },
        culturalValues: { utangNaLoob: +5, familyPiety: +5 },
        memory: "You received a balikbayan box from a relative abroad.",
        category: "family",
        importance: 2,
        emotion: "📦",
        relationships: [{ id: "family", change: +5 }],
        addInventory: "balikbayan_box"
      },
      {
        text: "You're asked to perform a special role in the local Santacruzan festival.",
        stats: { happiness: +15, relationships: +10, spirituality: +10 },
        culturalValues: { faith: +15, pakikisama: +10, kapwa: +5 },
        memory: "You participated in the Santacruzan festival in a special role.",
        category: "community",
        importance: 3,
        emotion: "👑",
        relationships: [{ id: "parish_community", change: +15 }, { id: "kapitbahay", change: +10 }]
      },
      {
        text: "Your suki (regular vendor) at the market gives you extra items for free.",
        stats: { finances: +5, happiness: +10 },
        culturalValues: { pakikisama: +10, utangNaLoob: +5 },
        memory: "Your suki at the market gave you free extra items.",
        category: "community",
        importance: 1,
        emotion: "🛒",
        relationships: [{ id: "suki", change: +15 }]
      },
      {
        text: "You're invited to join a local paluwagan (informal community savings group).",
        stats: { finances: +5, relationships: +10 },
        culturalValues: { pakikisama: +10, bayanihan: +5, diskarte: +10 },
        memory: "You joined a local paluwagan savings group.",
        category: "community",
        importance: 2,
        emotion: "💰",
        relationships: [{ id: "kapitbahay", change: +10 }]
      },
      {
        text: "A neighbor asks you to be a padrino/madrina (sponsor) for their child's graduation.",
        stats: { finances: -10, relationships: +15, happiness: +5 },
        culturalValues: { pakikisama: +15, utangNaLoob: +10, kapwa: +5 },
        memory: "You became a padrino/madrina for a neighbor's child's graduation.",
        category: "community",
        importance: 2,
        emotion: "🎓",
        relationships: [{ id: "kapitbahay", change: +15 }]
      },
      {
        text: "You're invited to join the choir at your local parish.",
        stats: { happiness: +10, relationships: +10, spirituality: +15 },
        culturalValues: { faith: +15, pakikisama: +10 },
        memory: "You joined your parish choir.",
        category: "spiritual",
        importance: 2,
        emotion: "🎵",
        relationships: [{ id: "parish_community", change: +20 }]
      },
      {
        text: "Your relative working abroad sends you a significant amount of money as pasalubong.",
        stats: { finances: +25, happiness: +10 },
        culturalValues: { utangNaLoob: +15 },
        memory: "Your OFW relative sent you a generous pasalubong.",
        category: "family",
        importance: 3,
        emotion: "💸",
        relationships: [{ id: "family", change: +10 }]
      }
    ];

    // DOM Elements
    const characterCreationPhase = document.getElementById('character-creation-phase');
    const mainGamePhase = document.getElementById('main-game-phase');
    const endingPhase = document.getElementById('ending-phase');
    const backgroundOptions = document.querySelectorAll('.background-option');
    const startGameBtn = document.getElementById('start-game');
    const scenarioTextEl = document.getElementById('scenario-text');
    const choicesContainerEl = document.getElementById('choices-container');
    const outcomeContainerEl = document.getElementById('outcome-container');
    const outcomeTextEl = document.getElementById('outcome-text');
    const decisionImpactEl = document.getElementById('decision-impact');
    const continueBtn = document.getElementById('continue-btn');
    const financeStatEl = document.getElementById('finance-stat');
    const happinessStatEl = document.getElementById('happiness-stat');
    const relationshipStatEl = document.getElementById('relationship-stat');
    const careerStatEl = document.getElementById('career-stat');
    const healthStatEl = document.getElementById('health-stat');
    const spiritualityStatEl = document.getElementById('spirituality-stat');
    const ageDisplayEl = document.getElementById('age-display');
    const lifeStageDisplayEl = document.getElementById('life-stage-display');
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');
    const relationshipsContainerEl = document.getElementById('relationship-container');
    const memoryContainerEl = document.getElementById('memory-container');
    const skillsContainerEl = document.getElementById('skills-container');
    const culturalValuesContainerEl = document.getElementById('cultural-values-container');
    const inventoryContainerEl = document.getElementById('inventory-container');
    const achievementContainerEl = document.getElementById('achievement-container');
    const notification = document.getElementById('notification');
    const toggleMusicBtn = document.getElementById('toggle-music');
    const memoryFilterBtns = document.querySelectorAll('.memory-filter-btn');
    const visualFeedback = document.getElementById('visual-feedback');

    // Audio Elements
    const backgroundMusic = new Audio('https://freepd.com/music/Tropical%20Beach.mp3');
    backgroundMusic.loop = true;
    backgroundMusic.volume = 0.3;

    // Sound Effects
    const soundEffects = {
      choice: new Audio('https://freesound.org/data/previews/242/242501_4414130-lq.mp3'),
      achievement: new Audio('https://freesound.org/data/previews/270/270402_5123851-lq.mp3'),
      aging: new Audio('https://freesound.org/data/previews/434/434479_8008085-lq.mp3'),
      positive: new Audio('https://freesound.org/data/previews/220/220173_4100837-lq.mp3'),
      negative: new Audio('https://freesound.org/data/previews/362/362205_6629363-lq.mp3')
    };

    // Initialize Game
    function initGame() {
      // Background Selection
      backgroundOptions.forEach(option => {
        option.addEventListener('click', function() {
          backgroundOptions.forEach(opt => opt.classList.remove('selected'));
          this.classList.add('selected');
          gameState.background = this.dataset.background;
          
          // Update initial stats based on background
          switch(gameState.background) {
            case "urban":
              gameState.stats.finances = 60;
              gameState.stats.career = 60;
              gameState.stats.relationships = 40;
              gameState.skills.education = 15;
              gameState.skills.technical = 15;
              gameState.culturalValues.diskarte = 40;
              break;
            case "provincial":
              gameState.stats.relationships = 70;
              gameState.stats.happiness = 60;
              gameState.stats.finances = 40;
              gameState.skills.resilience = 20;
              gameState.skills.cooking = 15;
              gameState.culturalValues.bayanihan = 50;
              gameState.culturalValues.familyPiety = 70;
              break;
            case "ofw":
              gameState.stats.finances = 70;
              gameState.stats.relationships = 40;
              gameState.stats.happiness = 40;
              gameState.skills.adaptability = 20;
              gameState.skills.resilience = 15;
              gameState.culturalValues.utangNaLoob = 50;
              gameState.culturalValues.pagiging_matiisin = 60;
              break;
            case "entrepreneurial":
              gameState.stats.finances = 50;
              gameState.stats.career = 50;
              gameState.stats.happiness = 55;
              gameState.skills.resourcefulness = 25;
              gameState.skills.leadership = 15;
              gameState.culturalValues.diskarte = 60;
              gameState.culturalValues.pagiging_masipag = 55;
              break;
          }
          
          startGameBtn.style.display = 'block';
          updateStatsDisplay();
        });
      });

      // Start Game Button
      startGameBtn.addEventListener('click', function() {
        characterCreationPhase.classList.add('hidden');
        mainGamePhase.classList.remove('hidden');
        
        // Add first memory based on background
        let backgroundMemory = "";
        switch(gameState.background) {
          case "urban":
            backgroundMemory = "You grew up in Metro Manila with access to better education but faced the challenges of city life.";
            break;
          case "provincial":
            backgroundMemory = "You were raised in a provincial town with strong community ties and traditional values.";
            break;
          case "ofw":
            backgroundMemory = "You grew up in a family where one or both parents worked abroad as OFWs.";
            break;
          case "entrepreneurial":
            backgroundMemory = "You were raised in a family that ran a small business, teaching you resourcefulness and hard work.";
            break;
        }
        
        addMemory(backgroundMemory, "family", {}, 4, "🏠");
        addMilestone("Childhood in the Philippines", backgroundMemory, 10);
        
        // Start the game with the first scenario
        presentScenario();
        
        // Start background music
        backgroundMusic.play();
        toggleMusicBtn.textContent = '🔊';
        
        // Update all displays
        updateStatsDisplay();
        updateRelationshipsDisplay();
        updateMemoriesDisplay();
        updateSkillsDisplay();
        updateCulturalValuesDisplay();
        updateInventoryDisplay();
        updateAchievementsDisplay();
      });

      // Tab Navigation
      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          const tabId = this.dataset.tab;
          
          tabs.forEach(t => t.classList.remove('active'));
          tabContents.forEach(c => c.classList.remove('active'));
          
          this.classList.add('active');
          document.getElementById(`${tabId}-tab`).classList.add('active');
          
          if (tabId === 'relationships') {
            updateRelationshipsDisplay();
          } else if (tabId === 'memories') {
            updateMemoriesDisplay();
          } else if (tabId === 'skills') {
            updateSkillsDisplay();
            updateCulturalValuesDisplay();
          } else if (tabId === 'inventory') {
            updateInventoryDisplay();
          } else if (tabId === 'achievements') {
            updateAchievementsDisplay();
          }
        });
      });

      // Memory Filtering
      memoryFilterBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          memoryFilterBtns.forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          updateMemoriesDisplay(this.dataset.filter);
        });
      });

      // Audio Controls
      toggleMusicBtn.addEventListener('click', function() {
        if (backgroundMusic.paused) {
          backgroundMusic.play();
          this.textContent = '🔊';
        } else {
          backgroundMusic.pause();
          this.textContent = '🔇';
        }
      });

      // Continue Button
      continueBtn.addEventListener('click', function() {
        outcomeContainerEl.style.display = 'none';
        choicesContainerEl.style.display = 'block';
        
        // Check for age progression
        if (gameState.currentScenario && gameState.currentScenario.advanceAge) {
          advanceAge();
        }
        
        // Present next scenario
        presentScenario();
      });

      // Restart Game Button
      document.getElementById('restart-game').addEventListener('click', function() {
        resetGame();
      });
    }

    // Present a scenario to the player
    function presentScenario() {
      // Check for pending consequences
      checkPendingConsequences();
      
      // Determine available scenarios based on life stage
      let availableScenarios;
      switch(gameState.lifeStage) {
        case "Young Adult":
          availableScenarios = scenarios.youngAdult;
          break;
        case "Adult":
          availableScenarios = scenarios.adult;
          break;
        case "Middle Age":
          availableScenarios = scenarios.middleAge;
          break;
        case "Senior":
          availableScenarios = scenarios.senior;
          break;
        default:
          availableScenarios = scenarios.youngAdult;
      }
      
      // Filter out scenarios that have already been presented
      const unseenScenarios = availableScenarios.filter(scenario => 
        !gameState.decisionHistory.includes(scenario.id)
      );
      
      // If no unseen scenarios, advance age
      if (unseenScenarios.length === 0) {
        advanceAge();
        return presentScenario();
      }
      
      // Random chance for random event instead of scenario
      if (Math.random() < 0.2) {
        presentRandomEvent();
        return;
      }
      
      // Select a random scenario from available ones
      const scenario = unseenScenarios[Math.floor(Math.random() * unseenScenarios.length)];
      gameState.currentScenario = scenario;
      
      // Display the scenario
      scenarioTextEl.textContent = scenario.text;
      
      // Add cultural context if available
      if (scenario.culturalContext) {
        const culturalContextEl = document.createElement('div');
        culturalContextEl.className = 'cultural-context';
        culturalContextEl.textContent = scenario.culturalContext;
        scenarioTextEl.appendChild(culturalContextEl);
      }
      
      // Display the choices
      choicesContainerEl.innerHTML = '';
      scenario.choices.forEach(choice => {
        const choiceBtn = document.createElement('button');
        choiceBtn.className = 'choice-btn';
        choiceBtn.textContent = choice.text;
        
        // Add cultural context to choice if available
        if (choice.culturalContext) {
          const contextSpan = document.createElement('div');
          contextSpan.className = 'choice-cultural-context';
          contextSpan.textContent = choice.culturalContext;
          choiceBtn.appendChild(contextSpan);
        }
        
        choiceBtn.addEventListener('click', () => makeChoice(choice));
        choicesContainerEl.appendChild(choiceBtn);
      });
    }

    // Present a random event
    function presentRandomEvent() {
      const event = randomEvents[Math.floor(Math.random() * randomEvents.length)];
      
      scenarioTextEl.textContent = event.text;
      choicesContainerEl.style.display = 'none';
      outcomeContainerEl.style.display = 'block';
      outcomeTextEl.textContent = event.text;
      
      // Apply event effects
      let impactText = "Impact: ";
      
      if (event.stats) {
        Object.entries(event.stats).forEach(([stat, value]) => {
          if (gameState.stats[stat] !== undefined) {
            gameState.stats[stat] = clampStat(gameState.stats[stat] + value);
            impactText += `${stat.charAt(0).toUpperCase() + stat.slice(1)} ${value >= 0 ? '+' : ''}${value}, `;
          }
        });
      }
      
      if (event.culturalValues) {
        Object.entries(event.culturalValues).forEach(([value, change]) => {
          if (gameState.culturalValues[value] !== undefined) {
            gameState.culturalValues[value] = clampStat(gameState.culturalValues[value] + change);
          }
        });
      }
      
      if (event.relationships) {
        event.relationships.forEach(rel => {
          updateRelationship(rel.id, rel.change);
          impactText += `${getRelationshipName(rel.id)} ${rel.change >= 0 ? '+' : ''}${rel.change}, `;
        });
      }
      
      // Add memory
      addMemory(event.memory, event.category || "general", event.impact || {}, event.importance || 1, event.emotion || "");
      
      // Add inventory item if specified
      if (event.addInventory) {
        addInventoryItem(event.addInventory);
      }
      
      // Update displays
      updateStatsDisplay();
      decisionImpactEl.textContent = impactText.slice(0, -2);
      
      // Play appropriate sound
      let overallImpact = 0;
      if (event.stats) {
        Object.values(event.stats).forEach(value => {
          overallImpact += value;
        });
      }
      
      if (overallImpact > 0) {
        playSound('positive');
        showVisualFeedback('positive');
      } else if (overallImpact < 0) {
        playSound('negative');
        showVisualFeedback('negative');
      } else {
        playSound('choice');
        showVisualFeedback('neutral');
      }
    }

    // Make a choice in a scenario
    function makeChoice(choice) {
      // Hide choices and show outcome
      choicesContainerEl.style.display = 'none';
      outcomeContainerEl.style.display = 'block';
      outcomeTextEl.textContent = choice.outcome;
      
      // Apply choice effects
      let impactText = "Impact: ";
      
      // Stats changes
      if (choice.stats) {
        Object.entries(choice.stats).forEach(([stat, value]) => {
          if (gameState.stats[stat] !== undefined) {
            gameState.stats[stat] = clampStat(gameState.stats[stat] + value);
            impactText += `${stat.charAt(0).toUpperCase() + stat.slice(1)} ${value >= 0 ? '+' : ''}${value}, `;
          }
        });
      }
      
      // Skills changes
      if (choice.skills) {
        Object.entries(choice.skills).forEach(([skill, value]) => {
          if (gameState.skills[skill] !== undefined) {
            gameState.skills[skill] = clampStat(gameState.skills[skill] + value);
          }
        });
      }
      
      // Cultural values changes
      if (choice.culturalValues) {
        Object.entries(choice.culturalValues).forEach(([value, change]) => {
          if (gameState.culturalValues[value] !== undefined) {
            gameState.culturalValues[value] = clampStat(gameState.culturalValues[value] + change);
          }
        });
      }
      
      // Relationship changes
      if (choice.relationships) {
        choice.relationships.forEach(rel => {
          updateRelationship(rel.id, rel.change);
          impactText += `${getRelationshipName(rel.id)} ${rel.change >= 0 ? '+' : ''}${rel.change}, `;
        });
      }
      
      // Add memory
      addMemory(choice.memory, choice.category || "general", choice.impact || {}, choice.importance || 1, choice.emotion || "");
      
      // Add to decision history
      gameState.decisionHistory.push(gameState.currentScenario.id);
      
      // Add inventory item if specified
      if (choice.addInventory) {
        addInventoryItem(choice.addInventory);
      }
      
      // Unlock achievement if specified
      if (choice.unlockAchievement) {
        unlockAchievement(choice.unlockAchievement);
      }
      
      // Add pending consequences if specified
      if (choice.pendingConsequences) {
        choice.pendingConsequences.forEach(consequence => {
          gameState.pendingConsequences.push(consequence);
        });
      }
      
      // Check for random event
      if (choice.randomEvent && Math.random() < choice.randomEvent.chance) {
        setTimeout(() => {
          presentRandomEventOutcome(choice.randomEvent.event);
        }, 2000);
      }
      
      // Update displays
      updateStatsDisplay();
      decisionImpactEl.textContent = impactText.slice(0, -2);
      
      // Play appropriate sound
      let overallImpact = 0;
      if (choice.stats) {
        Object.values(choice.stats).forEach(value => {
          overallImpact += value;
        });
      }
      
      if (overallImpact > 0) {
        playSound('positive');
        showVisualFeedback('positive');
      } else if (overallImpact < 0) {
        playSound('negative');
        showVisualFeedback('negative');
      } else {
        playSound('choice');
        showVisualFeedback('neutral');
      }
    }

    // Present a random event outcome from a choice
    function presentRandomEventOutcome(event) {
      outcomeTextEl.textContent = event.text;
      
      // Apply event effects
      let impactText = "Additional Impact: ";
      
      if (event.stats) {
        Object.entries(event.stats).forEach(([stat, value]) => {
          if (gameState.stats[stat] !== undefined) {
            gameState.stats[stat] = clampStat(gameState.stats[stat] + value);
            impactText += `${stat.charAt(0).toUpperCase() + stat.slice(1)} ${value >= 0 ? '+' : ''}${value}, `;
          }
        });
      }
      
      if (event.skills) {
        Object.entries(event.skills).forEach(([skill, value]) => {
          if (gameState.skills[skill] !== undefined) {
            gameState.skills[skill] = clampStat(gameState.skills[skill] + value);
          }
        });
      }
      
      if (event.culturalValues) {
        Object.entries(event.culturalValues).forEach(([value, change]) => {
          if (gameState.culturalValues[value] !== undefined) {
            gameState.culturalValues[value] = clampStat(gameState.culturalValues[value] + change);
          }
        });
      }
      
      if (event.relationships) {
        event.relationships.forEach(rel => {
          updateRelationship(rel.id, rel.change);
          impactText += `${getRelationshipName(rel.id)} ${rel.change >= 0 ? '+' : ''}${rel.change}, `;
        });
      }
      
      // Add memory
      addMemory(event.memory, event.category || "general", event.impact || {}, event.importance || 1, event.emotion || "");
      
      // Add inventory item if specified
      if (event.addInventory) {
        addInventoryItem(event.addInventory);
      }
      
      // Unlock achievement if specified
      if (event.unlockAchievement) {
        unlockAchievement(event.unlockAchievement);
      }
      
      // Update displays
      updateStatsDisplay();
      decisionImpactEl.textContent = impactText.slice(0, -2);
      
      // Play appropriate sound
      let overallImpact = 0;
      if (event.stats) {
        Object.values(event.stats).forEach(value => {
          overallImpact += value;
        });
      }
      
      if (overallImpact > 0) {
        playSound('positive');
        showVisualFeedback('positive');
      } else if (overallImpact < 0) {
        playSound('negative');
        showVisualFeedback('negative');
      } else {
        playSound('choice');
        showVisualFeedback('neutral');
      }
    }

    // Advance the player's age
    function advanceAge() {
      gameState.age += 5;
      
      // Add aging milestone
      addMilestone(`Age ${gameState.age}`, `You've reached ${gameState.age} years old.`, gameState.age);
      
      // Update life stage
      updateLifeStage();
      
      // Play aging sound
      playSound('aging');
      
      // Show notification
      showNotification(`You are now ${gameState.age} years old.`);
      
      // Check for game end
      if (gameState.age >= 80 || gameState.stats.health <= 0) {
        endGame();
        return;
      }
      
      // Update displays
      updateStatsDisplay();
    }

    // Update the player's life stage based on age
    function updateLifeStage() {
      let newLifeStage = "";
      
      if (gameState.age < 26) {
        newLifeStage = "Young Adult";
      } else if (gameState.age < 41) {
        newLifeStage = "Adult";
      } else if (gameState.age < 61) {
        newLifeStage = "Middle Age";
      } else {
        newLifeStage = "Senior";
      }
      
      // If life stage changed, add a memory
      if (newLifeStage !== gameState.lifeStage) {
        gameState.lifeStage = newLifeStage;
        addMemory(`You entered a new stage of life: ${gameState.lifeStage}.`, "personal", {}, 3, "⏳");
        showNotification(`You've entered a new life stage: ${gameState.lifeStage}`);
      }
    }

    // Check for pending consequences that should be applied
    function checkPendingConsequences() {
      const triggeredConsequences = [];
      
      gameState.pendingConsequences.forEach((consequence, index) => {
        let shouldTrigger = false;
        
        // Check age trigger
        if (consequence.triggerAge && gameState.age >= consequence.triggerAge) {
          shouldTrigger = true;
        }
        
        // Check stat condition trigger
        if (consequence.triggerCondition) {
          const { stat, operator, value } = consequence.triggerCondition;
          
          if (stat && operator && value !== undefined) {
            const currentValue = gameState.stats[stat];
            
            if (operator === ">" && currentValue > value) {
              shouldTrigger = true;
            } else if (operator === "<" && currentValue < value) {
              shouldTrigger = true;
            } else if (operator === "=" && currentValue === value) {
              shouldTrigger = true;
            }
          }
        }
        
        // Check relationship condition trigger
        if (consequence.triggerCondition && consequence.triggerCondition.relationship) {
          const { relationship, operator, value } = consequence.triggerCondition;
          
          const rel = gameState.relationships.find(r => r.id === relationship);
          if (rel) {
            const currentValue = rel.level;
            
            if (operator === ">" && currentValue > value) {
              shouldTrigger = true;
            } else if (operator === "<" && currentValue < value) {
              shouldTrigger = true;
            } else if (operator === "=" && currentValue === value) {
              shouldTrigger = true;
            }
          }
        }
        
        if (shouldTrigger) {
          triggeredConsequences.push({ consequence, index });
        }
      });
      
      // Apply triggered consequences in reverse order to avoid index issues when removing
      triggeredConsequences.sort((a, b) => b.index - a.index).forEach(({ consequence, index }) => {
        applyConsequence(consequence);
        gameState.pendingConsequences.splice(index, 1);
      });
    }

    // Apply a consequence
    function applyConsequence(consequence) {
      // Apply stat changes
      if (consequence.stats) {
        Object.entries(consequence.stats).forEach(([stat, value]) => {
          if (gameState.stats[stat] !== undefined) {
            gameState.stats[stat] = clampStat(gameState.stats[stat] + value);
          }
        });
      }
      
      // Apply relationship changes
      if (consequence.relationships) {
        Object.entries(consequence.relationships).forEach(([id, change]) => {
          updateRelationship(id, change, consequence.relationshipDescription);
        });
      }
      
      // Add memory
      if (consequence.memory) {
        addMemory(consequence.memory, consequence.category || "life", {}, consequence.importance || 3, consequence.emotion || "");
      }
      
      // Show notification
      if (consequence.notification) {
        showNotification(consequence.notification);
      }
      
      // Add inventory item if specified
      if (consequence.addInventory) {
        addInventoryItem(consequence.addInventory);
      }
      
      // Unlock achievement if specified
      if (consequence.unlockAchievement) {
        unlockAchievement(consequence.unlockAchievement);
      }
      
      // Update displays
      updateStatsDisplay();
      updateRelationshipsDisplay();
    }

    // Add a memory to the player's history
    function addMemory(text, category = "general", impact = {}, importance = 1, emotion = "") {
      if (!text) return;
      
      const memory = {
        age: gameState.age,
        lifeStage: gameState.lifeStage,
        text: text,
        category: category, // Categories: family, career, education, relationship, community, personal, spiritual
        importance: importance, // 1-5 scale, affects how much this memory influences future events
        impact: impact, // Object containing stats, relationships, or skills affected by this memory
        emotion: emotion, // Emoji representing the emotional tone of the memory
        timestamp: new Date().toISOString()
      };
      
      gameState.memories.push(memory);
      updateMemoriesDisplay();
    }

    // Add a milestone to the player's life history
    function addMilestone(title, description, age) {
      const milestone = {
        title: title,
        description: description,
        age: age,
        timestamp: new Date().toISOString()
      };
      
      gameState.milestones.push(milestone);
    }

    // Update a relationship with another character
    function updateRelationship(id, change, description = "") {
      const relationship = gameState.relationships.find(r => r.id === id);
      
      if (relationship) {
        relationship.level = clampStat(relationship.level + change);
        relationship.unlocked = true;
        
        // Add to relationship history
        relationship.history.push({
          age: gameState.age,
          change: change,
          description: description || `Relationship changed by ${change}`,
          timestamp: new Date().toISOString()
        });
        
        // Check for pakikisama_master achievement
        if (gameState.relationships.every(r => r.unlocked && r.level >= 50)) {
          unlockAchievement("pakikisama_master");
        }
      }
    }

    // Get relationship name by ID
    function getRelationshipName(id) {
      const relationship = gameState.relationships.find(r => r.id === id);
      return relationship ? relationship.name : id;
    }

    // Add an item to the player's inventory
    function addInventoryItem(itemId) {
      const item = inventoryItems.find(i => i.id === itemId);
      if (item && !gameState.inventory.some(i => i.id === itemId)) {
        gameState.inventory.push({...item});
        showNotification(`New item acquired: ${item.name}`);
        updateInventoryDisplay();
      }
    }

    // Unlock an achievement
    function unlockAchievement(achievementId) {
      const achievement = gameState.achievements.find(a => a.id === achievementId);
      if (achievement && !achievement.unlocked) {
        achievement.unlocked = true;
        showNotification(`Achievement unlocked: ${achievement.name}`);
        playSound('achievement');
        updateAchievementsDisplay();
      }
    }

    // Update the stats display
    function updateStatsDisplay() {
      financeStatEl.textContent = clampStat(gameState.stats.finances);
      happinessStatEl.textContent = clampStat(gameState.stats.happiness);
      relationshipStatEl.textContent = clampStat(gameState.stats.relationships);
      careerStatEl.textContent = clampStat(gameState.stats.career);
      healthStatEl.textContent = clampStat(gameState.stats.health);
      spiritualityStatEl.textContent = clampStat(gameState.stats.spirituality);
      ageDisplayEl.textContent = `Age: ${gameState.age}`;
      lifeStageDisplayEl.textContent = gameState.lifeStage;
    }

    // Update the relationships display
    function updateRelationshipsDisplay() {
      relationshipsContainerEl.innerHTML = '';
      
      // Sort relationships by level (highest first)
      const sortedRelationships = [...gameState.relationships]
        .filter(r => r.unlocked)
        .sort((a, b) => b.level - a.level);
      
      sortedRelationships.forEach(relationship => {
        const relationshipElement = document.createElement('div');
        relationshipElement.className = 'relationship';
        
        // Determine icon based on relationship type
        let icon = '👤';
        switch(relationship.type) {
          case 'family':
            icon = '👪';
            break;
          case 'friends':
            icon = '🤝';
            break;
          case 'romantic':
            icon = '❤️';
            break;
          case 'career':
            icon = '💼';
            break;
          case 'community':
            icon = '🏘️';
            break;
        }
        
        // Get recent history
        let recentChange = '';
        if (relationship.history && relationship.history.length > 0) {
          const latestHistory = relationship.history[relationship.history.length - 1];
          const changeValue = latestHistory.change;
          
          if (changeValue > 0) {
            recentChange = `<span class="relationship-change positive">+${changeValue}</span>`;
          } else if (changeValue < 0) {
            recentChange = `<span class="relationship-change negative">${changeValue}</span>`;
          }
        }
        
        relationshipElement.innerHTML = `
          <div class="relationship-icon">${icon}</div>
          <div class="relationship-info">
            <div class="relationship-name">${relationship.name} ${recentChange}</div>
            <div class="relationship-description">${relationship.description}</div>
            <div class="relationship-level">Relationship Level: ${relationship.level}/100</div>
            <div class="relationship-expectation">${relationship.expectations}</div>
          </div>
        `;
        
        relationshipsContainerEl.appendChild(relationshipElement);
      });
    }

    // Update the memories display with optional filter
    function updateMemoriesDisplay(filter = 'all') {
      memoryContainerEl.innerHTML = '';
      
      // Filter and sort memories (newest first)
      let filteredMemories = [...gameState.memories].sort((a, b) => 
        new Date(b.timestamp) - new Date(a.timestamp)
      );
      
      if (filter !== 'all') {
        if (filter === 'important') {
          filteredMemories = filteredMemories.filter(m => m.importance >= 4);
        } else {
          filteredMemories = filteredMemories.filter(m => m.category === filter);
        }
      }
      
      filteredMemories.forEach(memory => {
        const memoryElement = document.createElement('div');
        memoryElement.className = 'memory';
        
        // Create importance stars
        let importanceStars = '';
        for (let i = 1; i <= 5; i++) {
          if (i <= memory.importance) {
            importanceStars += '<span class="importance-star">★</span>';
          } else {
            importanceStars += '<span class="importance-star empty">★</span>';
          }
        }
        
        // Create impact text if any
        let impactText = '';
        if (memory.impact && Object.keys(memory.impact).length > 0) {
          impactText = '<div class="memory-impact">';
          
          Object.entries(memory.impact).forEach(([key, value]) => {
            const className = value >= 0 ? 'memory-impact-positive' : 'memory-impact-negative';
            impactText += `<span class="${className}">${key}: ${value >= 0 ? '+' : ''}${value}</span>`;
          });
          
          impactText += '</div>';
        }
        
        // Create emotion display if any
        let emotionDisplay = memory.emotion ? `<span class="memory-emotion">${memory.emotion}</span>` : '';
        
        memoryElement.innerHTML = `
          <div class="memory-age">Age ${memory.age} (${memory.lifeStage}) ${emotionDisplay}</div>
          <div class="memory-text">${memory.text}</div>
          <div class="memory-category">${memory.category.charAt(0).toUpperCase() + memory.category.slice(1)}</div>
          <div class="memory-importance">${importanceStars}</div>
          ${impactText}
        `;
        
        memoryContainerEl.appendChild(memoryElement);
      });
      
      // Show message if no memories match filter
      if (filteredMemories.length === 0) {
        memoryContainerEl.innerHTML = `<p>No memories in the "${filter}" category yet.</p>`;
      }
    }

    // Update the skills display
    function updateSkillsDisplay() {
      skillsContainerEl.innerHTML = '';
      
      Object.entries(gameState.skills).forEach(([skill, level]) => {
        const skillElement = document.createElement('div');
        skillElement.className = 'skill';
        
        // Format skill name
        const formattedSkill = skill.split('_')
          .map(word => word.charAt(0).toUpperCase() + word.slice(1))
          .join(' ');
        
        skillElement.innerHTML = `
          <div class="skill-name">${formattedSkill}</div>
          <div class="skill-bar">
            <div class="skill-fill" style="width: ${level}%;"></div>
          </div>
          <div>${level}/100</div>
        `;
        
        skillsContainerEl.appendChild(skillElement);
      });
    }

    // Update the cultural values display
    function updateCulturalValuesDisplay() {
      culturalValuesContainerEl.innerHTML = '';
      
      // Define descriptions for cultural values
      const valueDescriptions = {
        utangNaLoob: "Debt of gratitude; obligation to reciprocate kindness",
        pakikisama: "Getting along with others; maintaining smooth interpersonal relationships",
        bayanihan: "Community spirit; working together for common goals",
        familyPiety: "Respect and care for family; prioritizing family needs",
        hiya: "Sense of shame/propriety; concern for social approval",
        delicadeza: "Sense of propriety; ethical refinement",
        pagiging_matiisin: "Perseverance; ability to endure hardship",
        pagiging_masipag: "Industriousness; hard work ethic",
        respeto: "Respect for elders and authority",
        faith: "Religious/spiritual devotion",
        pagtitiis: "Endurance; ability to sacrifice for greater good",
        diskarte: "Resourcefulness; street smarts; creative problem-solving",
        kapwa: "Shared identity; treating others as fellow humans",
        amor_propio: "Self-esteem; personal dignity"
      };
      
      Object.entries(gameState.culturalValues).forEach(([value, level]) => {
        const valueElement = document.createElement('div');
        valueElement.className = 'cultural-value';
        
        // Format value name
        const formattedValue = value.split('_')
          .map(word => word.charAt(0).toUpperCase() + word.slice(1))
          .join(' ');
        
        valueElement.innerHTML = `
          <div class="cultural-value-name">${formattedValue}</div>
          <div class="cultural-value-description">${valueDescriptions[value] || ""}</div>
          <div class="cultural-value-bar">
            <div class="cultural-value-fill" style="width: ${level}%;"></div>
          </div>
          <div>${level}/100</div>
        `;
        
        culturalValuesContainerEl.appendChild(valueElement);
      });
    }

    // Update the inventory display
    function updateInventoryDisplay() {
      inventoryContainerEl.innerHTML = '';
      
      if (gameState.inventory.length === 0) {
        inventoryContainerEl.innerHTML = '<p>You have no items yet.</p>';
        return;
      }
      
      gameState.inventory.forEach(item => {
        const itemElement = document.createElement('div');
        itemElement.className = 'inventory-item';
        
        // Create effect text
        let effectText = '';
        if (item.effect) {
          effectText = '<div class="inventory-effect">';
          
          Object.entries(item.effect).forEach(([stat, value]) => {
            effectText += `<span>${stat}: +${value}</span> `;
          });
          
          effectText += '</div>';
        }
        
        itemElement.innerHTML = `
          <div class="inventory-icon">${item.icon}</div>
          <div class="inventory-info">
            <div class="inventory-name">${item.name}</div>
            <div class="inventory-description">${item.description}</div>
            ${effectText}
            <div class="cultural-context">${item.culturalContext || ""}</div>
          </div>
        `;
        
        inventoryContainerEl.appendChild(itemElement);
      });
    }

    // Update the achievements display
    function updateAchievementsDisplay() {
      achievementContainerEl.innerHTML = '';
      
      gameState.achievements.forEach(achievement => {
        const achievementElement = document.createElement('div');
        achievementElement.className = achievement.unlocked ? 'achievement' : 'achievement achievement-locked';
        
        achievementElement.innerHTML = `
          <div class="achievement-icon">${achievement.icon}</div>
          <div class="achievement-info">
            <div class="achievement-name">${achievement.name}</div>
            <div class="achievement-description">${achievement.description}</div>
          </div>
        `;
        
        achievementContainerEl.appendChild(achievementElement);
      });
    }

    // Clamp a stat value between 0 and 100
    function clampStat(value) {
      return Math.max(0, Math.min(100, value));
    }

    // Play a sound effect
    function playSound(soundName) {
      if (soundEffects[soundName]) {
        soundEffects[soundName].currentTime = 0;
        soundEffects[soundName].play();
      }
    }

    // Show visual feedback for decisions
    function showVisualFeedback(type) {
      visualFeedback.className = `visual-feedback ${type}`;
      visualFeedback.classList.add('show');
      
      setTimeout(() => {
        visualFeedback.classList.remove('show');
      }, 1000);
    }

    // Show a notification
    function showNotification(message) {
      notification.textContent = message;
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }

    // End the game
    function endGame() {
      mainGamePhase.classList.add('hidden');
      endingPhase.classList.remove('hidden');
      
      // Set final stats
      document.getElementById('final-finance-stat').textContent = gameState.stats.finances;
      document.getElementById('final-happiness-stat').textContent = gameState.stats.happiness;
      document.getElementById('final-relationship-stat').textContent = gameState.stats.relationships;
      document.getElementById('final-career-stat').textContent = gameState.stats.career;
      document.getElementById('final-health-stat').textContent = gameState.stats.health;
      document.getElementById('final-spirituality-stat').textContent = gameState.stats.spirituality;
      
      // Display memories
      const finalMemoryContainer = document.getElementById('final-memory-container');
      finalMemoryContainer.innerHTML = '';
      
      // Display milestones instead of all memories
      gameState.milestones.forEach(milestone => {
        const milestoneElement = document.createElement('div');
        milestoneElement.className = 'life-milestone';
        
        milestoneElement.innerHTML = `
          <div class="milestone-title">${milestone.title}</div>
          <div class="milestone-description">${milestone.description}</div>
          <div class="milestone-age">Age: ${milestone.age}</div>
        `;
        
        finalMemoryContainer.appendChild(milestoneElement);
      });
      
      // Display important memories
      const importantMemories = gameState.memories
        .filter(m => m.importance >= 4)
        .sort((a, b) => a.age - b.age);
      
      importantMemories.forEach(memory => {
        const memoryElement = document.createElement('div');
        memoryElement.className = 'memory';
        
        // Create importance stars
        let importanceStars = '';
        for (let i = 1; i <= 5; i++) {
          if (i <= memory.importance) {
            importanceStars += '<span class="importance-star">★</span>';
          } else {
            importanceStars += '<span class="importance-star empty">★</span>';
          }
        }
        
        // Create emotion display if any
        let emotionDisplay = memory.emotion ? `<span class="memory-emotion">${memory.emotion}</span>` : '';
        
        memoryElement.innerHTML = `
          <div class="memory-age">Age ${memory.age} (${memory.lifeStage}) ${emotionDisplay}</div>
          <div class="memory-text">${memory.text}</div>
          <div class="memory-category">${memory.category.charAt(0).toUpperCase() + memory.category.slice(1)}</div>
          <div class="memory-importance">${importanceStars}</div>
        `;
        
        finalMemoryContainer.appendChild(memoryElement);
      });
      
      // Display achievements
      const finalAchievementContainer = document.getElementById('final-achievement-container');
      finalAchievementContainer.innerHTML = '';
      
      const unlockedAchievements = gameState.achievements.filter(a => a.unlocked);
      
      if (unlockedAchievements.length === 0) {
        finalAchievementContainer.innerHTML = '<p>You did not unlock any achievements in this life.</p>';
      } else {
        unlockedAchievements.forEach(achievement => {
          const achievementElement = document.createElement('div');
          achievementElement.className = 'achievement';
          
          achievementElement.innerHTML = `
            <div class="achievement-icon">${achievement.icon}</div>
            <div class="achievement-info">
              <div class="achievement-name">${achievement.name}</div>
              <div class="achievement-description">${achievement.description}</div>
            </div>
          `;
          
          finalAchievementContainer.appendChild(achievementElement);
        });
      }
      
      // Determine ending title and description
      let endingTitle = "Your Life's Journey Has Ended";
      let endingDescription = "";
      
      if (gameState.stats.health <= 0) {
        endingTitle = "Your Life Has Come to an Early End";
        endingDescription = "Due to health complications, your journey ended at age " + gameState.age + ".";
      } else {
        endingTitle = "You've Lived a Full Life";
        endingDescription = "You've reached the age of " + gameState.age + " and lived a life shaped by your choices and Filipino values.";
      }
      
      // Add life summary based on stats and achievements
      endingDescription += "\n\n";
      
      // Career summary
      if (gameState.careerPath) {
        let careerSummary = "";
        switch(gameState.careerPath) {
          case "corporate":
            careerSummary = "You built a successful corporate career, climbing the ladder of professional achievement.";
            break;
          case "entrepreneur":
            careerSummary = "You forged your own path as an entrepreneur, creating opportunities for yourself and others.";
            break;
          case "public_service":
            careerSummary = "You dedicated your career to public service, working for the betterment of society.";
            break;
          case "creative":
            careerSummary = "You pursued your creative passions, enriching the cultural landscape with your talents.";
            break;
        }
        endingDescription += careerSummary + " ";
      }
      
      // Family summary
      if (gameState.stats.relationships >= 70) {
        endingDescription += "You maintained strong family bonds throughout your life, embodying the Filipino value of family first. ";
      } else if (gameState.stats.relationships >= 50) {
        endingDescription += "You balanced family relationships with other aspects of life. ";
      } else {
        endingDescription += "Your focus on other aspects of life sometimes came at the expense of family relationships. ";
      }
      
      // Financial summary
      if (gameState.stats.finances >= 70) {
        endingDescription += "You achieved financial prosperity and security. ";
      } else if (gameState.stats.finances >= 50) {
        endingDescription += "You maintained a comfortable financial situation. ";
      } else {
        endingDescription += "You faced financial challenges throughout your life. ";
      }
      
      // Happiness summary
      if (gameState.stats.happiness >= 70) {
        endingDescription += "You found great joy and satisfaction in your life choices. ";
      } else if (gameState.stats.happiness >= 50) {
        endingDescription += "You experienced a reasonable amount of happiness in your life. ";
      } else {
        endingDescription += "You struggled to find lasting happiness despite your efforts. ";
      }
      
      // Achievement summary
      const achievementCount = gameState.achievements.filter(a => a.unlocked).length;
      if (achievementCount >= 7) {
        endingDescription += "Your life was remarkable, filled with numerous achievements and milestones.";
      } else if (achievementCount >= 4) {
        endingDescription += "You accomplished several meaningful achievements throughout your journey.";
      } else if (achievementCount >= 1) {
        endingDescription += "You reached some important milestones in your life journey.";
      } else {
        endingDescription += "Your life was lived quietly, focusing on the simple things.";
      }
      
      document.getElementById('ending-title').textContent = endingTitle;
      document.getElementById('ending-description').textContent = endingDescription;
    }

    // Reset the game
    function resetGame() {
      // Reset game state
      gameState.age = 18;
      gameState.lifeStage = "Young Adult";
      gameState.background = "";
      
      // Reset stats
      Object.keys(gameState.stats).forEach(stat => {
        gameState.stats[stat] = 50;
      });
      gameState.stats.health = 70;
      
      // Reset skills
      Object.keys(gameState.skills).forEach(skill => {
        gameState.skills[skill] = 10;
      });
      gameState.skills.cooking = 5;
      gameState.skills.language = 15;
      gameState.skills.resourcefulness = 20;
      gameState.skills.adaptability = 15;
      gameState.skills.negotiation = 5;
      gameState.skills.teaching = 5;
      gameState.skills.management = 5;
      gameState.skills.networking = 5;
      
      // Reset cultural values
      Object.keys(gameState.culturalValues).forEach(value => {
        gameState.culturalValues[value] = 30;
      });
      gameState.culturalValues.pakikisama = 40;
      gameState.culturalValues.familyPiety = 60;
      gameState.culturalValues.pagiging_matiisin = 40;
      gameState.culturalValues.pagiging_masipag = 45;
      gameState.culturalValues.respeto = 50;
      gameState.culturalValues.faith = 45;
      gameState.culturalValues.pagtitiis = 35;
      gameState.culturalValues.diskarte = 30;
      gameState.culturalValues.kapwa = 40;
      gameState.culturalValues.amor_propio = 35;
      
      // Reset relationships
      gameState.relationships.forEach(relationship => {
        if (relationship.id === "family") {
          relationship.level = 50;
        } else if (relationship.id === "friends") {
          relationship.level = 50;
        } else if (relationship.id === "romantic") {
          relationship.level = 0;
          relationship.unlocked = false;
        } else if (relationship.id === "lola") {
          relationship.level = 60;
        } else if (relationship.id === "barkada") {
          relationship.level = 40;
        } else {
          relationship.level = 30;
        }
        relationship.history = [];
      });
      
      // Reset memories, inventory, and other arrays
      gameState.memories = [];
      gameState.inventory = [];
      gameState.milestones = [];
      gameState.pendingConsequences = [];
      
      // Reset achievements
      gameState.achievements.forEach(achievement => achievement.unlocked = false);
      gameState.careerPath = "";
      gameState.decisionHistory = [];
      gameState.currentScenario = null;
      gameState.isDead = false;
      gameState.causeOfDeath = "";
      
      endingPhase.classList.add('hidden');
      characterCreationPhase.classList.remove('hidden');
      backgroundOptions.forEach(opt => opt.classList.remove('selected'));
      startGameBtn.style.display = 'none';
    }

    // Initialize the game
    initGame();
  </script>
</body>
</html>